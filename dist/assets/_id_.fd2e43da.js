import{_ as dt}from"./VTabs.c0749178.js";import{a as K,u as tt,_ as mt}from"./VPlaceholderSection.2f3a5682.js";import{A as z,W as R,B as _,o as s,g as B,w as n,k as t,s as a,x as et,p as D,t as e,G as $,Q as T,N as _t,f as X,P as E,b as at,bw as Z,q as H,j as m,m as C,F as O,v as pt,af as ft,r as ht,a2 as yt,a3 as vt,bP as bt,C as $t}from"./index.433ccf37.js";import{_ as gt}from"./VFileInput.4f9e647b.js";import{j as wt,h as Vt,k as kt,l as Ct,m as St}from"./index.bd8beb4a.js";import{_ as Nt}from"./ContractFormModal.15768956.js";import{b as ot,_ as Mt,a as Dt}from"./VFlexTable.284f6416.js";import{_ as Pt}from"./ListWidgetSingle.ab1f350c.js";import{_ as Ft}from"./VTag.9c6106fb.js";import{_ as J}from"./VFlexItem.0a7b51f8.js";import{u as It}from"./viewWrapper.5bc32d10.js";import{_ as At}from"./ConfirmActionModal.97a9d993.js";import{_ as Ut}from"./VButtons.56d3a59a.js";import{_ as xt}from"./StatusTag.a13087bb.js";import"./index.44bf4aef.js";const Lt=["onSubmit"],Bt={class:"columns is-multiline"},Tt={class:"column is-12"},Yt=z({props:{modelValue:{type:Boolean,default:!1},contractId:{default:""},filePropName:null},emits:["update:modelValue","update:data"],setup(i,{emit:o}){const p=i,{t:c,locale:P}=R(),u=_([]),d=_("");let A=_(c("Add_file"));async function g(f){try{if(u.value.length){const h=new FormData;h.append(p.filePropName,u.value[0]??""),await wt(Number(p.contractId),h),o("update:data"),l()}else d.value=c("File_upload_field_required")}catch(h){Object.assign(errors,h.response?.data?.errors)}}function l(){u.value=[],d.value="",o("update:modelValue",!1)}function b(f){const h=f.target;u.value=h.files&&[h.files[0]],d.value=""}function w(){u.value=[]}return(f,h)=>{const v=gt,M=T,S=K;return s(),B(S,{open:i.modelValue,size:"large",title:$(A),actions:"right",onClose:l},{content:n(()=>[t("form",{id:"submit-form2",class:"modal-form",onSubmit:et(g,["prevent"])},[t("div",Bt,[t("div",Tt,[a(v,{files:u.value,onFileUpload:b,onFileRemove:w,"error-message":d.value,"remote-files":[]},null,8,["files","error-message"])])])],40,Lt)]),action:n(({close:F})=>[a(M,{color:"primary",outlined:"",type:"submit",form:"submit-form2"},{default:n(()=>[D(e(f.$t("Save")),1)]),_:1})]),_:1},8,["open","title"])}}});const jt={class:"container is-fluid"},zt={class:"columns"},Ot={class:"column is-6"},Rt={class:"table is-hoverable is-bordered is-fullwidth mb-5"},Wt={class:"has-text-weight-bold"},Ht={class:"has-text-weight-bold"},Et={class:"has-text-weight-bold"},qt={class:"has-text-weight-bold"},Gt={class:"has-text-weight-bold"},Qt={class:"table is-hoverable is-bordered is-fullwidth"},Jt={class:"has-text-weight-bold"},Kt={class:"is-flex is-align-items-center"},Xt=["href"],Zt={class:"mr-3"},te={key:1,class:"has-text-danger"},ee={class:"has-text-weight-bold"},ae={class:"is-flex is-align-items-center"},oe=["href"],ne={class:"mr-3"},le={key:1,class:"has-text-danger"},se={class:"has-text-weight-bold"},ie={class:"is-flex is-align-items-center"},ce=["href"],re={class:"mr-3"},ue={key:1,class:"has-text-danger"},de={class:"column is-6"},me={class:"table is-hoverable is-bordered is-fullwidth"},_e=z({async setup(i){let o,p;const{t:c,locale:P}=R(),u=X(()=>({name:{label:c("Name"),searchable:!0},legal_entity:{label:c("Applicant")},payment_amount:{label:c("Contract_amount")},template_file:{label:c("Template_file")},legal_file:{label:c("Legal_entity_file")},file:{label:c("File")},verified_at:{label:c("Payment_status")},created_at:{label:c("Date")}})),d=_(!1),g=E().params?.id??null,l=_(),b=_(),w=_(""),f=_(!1),h=at();[o,p]=Z(()=>v()),await o,p();async function v(){const r=await Vt(Number(g));l.value=await r,b.value=l.value?.applications}function M(r){w.value=r,d.value=!0}function S(){f.value=!0}function F(){h.success(c("Updated_successfully"))}return(r,V)=>{const U=H("VueIconify"),y=Ft,N=Pt,I=H("RouterLink"),x=ot,G=Nt,Q=Yt;return s(),m("div",jt,[t("div",zt,[t("div",Ot,[a(N,{title:r.$t("Contract_details"),straight:"",class:"list-widget-v3"},{actions:n(()=>[l.value?.verified_at?C("",!0):(s(),m("a",{key:0,href:"javascript:;",onClick:S},[a(U,{icon:"feather:edit-2"})]))]),default:n(()=>[t("table",Rt,[t("tbody",null,[t("tr",null,[t("td",Wt,e($(u).name.label),1),t("td",null,e(l.value?.name),1)]),t("tr",null,[t("td",Ht,e($(u).payment_amount.label),1),t("td",null,e(l.value?.payment_amount.toLocaleString()),1)]),t("tr",null,[t("td",Et,e($(u).legal_entity.label),1),t("td",null,e(l.value?.legal_entity?.name),1)]),t("tr",null,[t("td",qt,e($(u).created_at.label),1),t("td",null,e(r.$h.formatDate(l.value?.created_at,"DD.MM.YYYY")),1)]),t("tr",null,[t("td",Gt,e($(u).verified_at.label),1),t("td",null,[a(y,{class:"is-size-6",color:l.value.verified_at?"primary":"warning",rounded:"",label:l.value.verified_at?r.$t("Paid"):r.$t("Not_Paid")},null,8,["color","label"])])])])])]),_:1},8,["title"]),a(N,{title:r.$t("Contract_files_list"),straight:"",class:"list-widget-v3"},{default:n(()=>[t("table",Qt,[t("tbody",null,[t("tr",null,[t("td",Jt,e($(u).template_file.label),1),t("td",Kt,[l.value?.template_file?(s(),m("a",{key:0,href:l.value?.template_file,class:"has-text-primary",download:""},[t("span",Zt,e(r.$t("Download")),1),a(U,{icon:"feather:link"})],8,Xt)):(s(),m("span",te,e(r.$t("No_template_file")),1)),a(T,{class:"ml-auto",color:"primary",rounded:"",icon:"fas fa-plus",onClick:V[0]||(V[0]=k=>M("template_file"))},{default:n(()=>[D(e(r.$t("Upload")),1)]),_:1})])]),t("tr",null,[t("td",ee,e($(u).legal_file.label),1),t("td",ae,[l.value?.legal_file?(s(),m("a",{key:0,href:l.value?.legal_file,class:"has-text-primary",download:""},[t("span",ne,e(r.$t("Download")),1),a(U,{icon:"feather:link"})],8,oe)):(s(),m("span",le,e(r.$t("No_legal_file")),1))])]),t("tr",null,[t("td",se,e($(u).file.label),1),t("td",ie,[l.value?.file?(s(),m("a",{key:0,href:l.value?.file,class:"has-text-primary",download:""},[t("span",re,e(r.$t("Download")),1),a(U,{icon:"feather:link"})],8,ce)):(s(),m("span",ue,e(r.$t("No_completed_file")),1)),a(T,{class:"ml-auto",color:"primary",rounded:"",icon:"fas fa-plus",onClick:V[1]||(V[1]=k=>M("file"))},{default:n(()=>[D(e(r.$t("Upload")),1)]),_:1})])])])])]),_:1},8,["title"])]),t("div",de,[a(N,{title:r.$t("Statements_List"),straight:"",class:"list-widget-v3"},{default:n(()=>[t("table",me,[t("thead",null,[t("tr",null,[t("th",null,e(r.$t("Statement_code")),1),t("th",null,e(r.$t("Drug_name")),1),t("th",null,e(r.$t("Status")),1)])]),t("tbody",null,[(s(!0),m(O,null,pt(b.value,k=>(s(),m("tr",null,[t("td",null,[a(I,{class:"has-text-primary",to:`/app/statements/${k.id}`},{default:n(()=>[D(e(k.code),1)]),_:2},1032,["to"])]),t("td",null,e(k.drug),1),t("td",null,[a(x,{"justify-content":"space-between"},{default:n(()=>[a(J,null,{default:n(()=>[a(y,{class:"is-size-6",color:k.is_paid?"primary":"warning",rounded:"",label:k.is_paid?r.$t("Paid"):r.$t("Not_Paid")},null,8,["color","label"])]),_:2},1024),k.is_paid&&!l.value?.verified_at?(s(),B(J,{key:0},{default:n(()=>[a(T,{color:"warning",rounded:"",textContent:e(r.$t("Reject_statement_status"))},null,8,["textContent"])]),_:1})):C("",!0)]),_:2},1024)])]))),256))])])]),_:1},8,["title"])])]),a(G,{modelValue:f.value,"onUpdate:modelValue":V[2]||(V[2]=k=>f.value=k),"item-id":Number($(g)),"onUpdate:list":V[3]||(V[3]=()=>{v(),F(),g.value=""})},null,8,["modelValue","item-id"]),a(Q,{modelValue:d.value,"onUpdate:modelValue":V[4]||(V[4]=k=>d.value=k),"contract-id":$(g),onClose:v,"file-prop-name":w.value,"onUpdate:data":v},null,8,["modelValue","contract-id","file-prop-name"])])}}}),pe=_t(_e,[["__scopeId","data-v-37db5c87"]]),fe={class:"table is-bordered is-fullwidth"},he={class:"has-text-weight-bold"},ye={class:"has-text-right is-size-5 has-text-weight-bold"},ve={class:"has-text-weight-bold"},be={class:"has-text-right is-size-5 has-text-weight-bold"},$e={colspan:"2",class:"is-size-5 has-text-weight-bold"},ge={key:0},we={key:1},Ve=z({props:{contract:null,modelValue:null},emits:["update:modelValue","confirmAction"],setup(i,{emit:o}){const p=tt(),c=X(()=>p.confirmModalOkButtonColor);async function P(){p.$patch({confirmState:!0}),u(),o("confirmAction")}function u(){o("update:modelValue",!1)}return(d,A)=>{const g=mt,l=T,b=K;return s(),B(b,{open:i.modelValue,actions:"center",title:d.$t("Confirm_action"),noclose:!0,onClose:u,"cancel-label":d.$t("No")},{content:n(()=>[a(g,{title:d.$t("Are_you_sure")+"?"},null,8,["title"]),t("table",fe,[t("tbody",null,[t("tr",null,[t("td",null,[t("span",he,e(d.$t("Contract_sum")),1)]),t("td",ye,[t("span",null,e(i.contract.payment_amount.toLocaleString()),1)])]),t("tr",null,[t("td",null,[t("span",ve,e(d.$t("Payment_total_sum")),1)]),t("td",be,[t("span",null,e(i.contract.payment_total_sum.toLocaleString()),1)])]),t("tr",null,[t("td",$e,[i.contract.payment_amount>i.contract.payment_total_sum?(s(),m("span",ge,e(d.$t("Contract_sum_more"))+": "+e((i.contract.payment_amount-i.contract.payment_total_sum).toLocaleString()),1)):i.contract.payment_amount<i.contract.payment_total_sum?(s(),m("span",we,e(d.$t("Contract_sum_less"))+": "+e((i.contract.payment_total_sum-i.contract.payment_amount).toLocaleString()),1)):C("",!0)])])])])]),action:n(()=>[a(l,{type:"button",class:"is-justify-content-center",color:$(c),outlined:"",onClick:P},{default:n(()=>[D(e(d.$t("Yes")),1)]),_:1},8,["color"])]),_:1},8,["open","title","cancel-label"])}}}),q=ft();async function ke(i,o){try{const{data:p}=await q({url:`/api/admin/payment/${i}/verify`,method:"PUT",data:{applications:o}});return p.data}catch(p){throw p}}async function Ce(i){try{const{data:o}=await q({url:`/api/admin/payment/${i}/cancel`,method:"PUT"});return o.data}catch(o){throw o}}async function Se(i){try{const{data:o}=await q({url:`/api/admin/appcontract/${i}/verify`,method:"PUT"});return o.data}catch(o){throw o}}async function Ne(i){try{const{data:o}=await q({url:`/api/admin/appcontract/${i}/application/not-verified`,method:"GET"});return o.data}catch(o){throw o}}const Me=["onSubmit"],De={class:"columns is-multiline"},Pe={class:"column is-12"},Fe={class:"help has-text-danger"},Ie=z({props:{modelValue:Boolean,paymentId:{type:Number,default:null}},emits:["update:modelValue","update:list"],async setup(i,{emit:o}){let p,c;const P=i,{t:u,locale:d}=R(),g=E().params?.id??null;let l=_(u("Verify_payment"));const b=_(),w=_([]),f=ht({applications:""});[p,c]=Z(()=>h()),await p,c();async function h(){try{const S=await Ne(Number(g));b.value=S}catch(S){console.log(S)}}async function v(S){try{await ke(P.paymentId,w.value),o("update:list"),M()}catch(F){Object.assign(f,F.response?.data?.errors)}}function M(){w.value=[],o("update:modelValue",!1)}return(S,F)=>{const r=H("Multiselect"),V=yt,U=vt,y=T,N=K;return s(),B(N,{open:i.modelValue,size:"large",title:$(l),actions:"right",onClose:M},{content:n(()=>[t("form",{id:"payment-verify-form",class:"modal-form",onSubmit:et(v,["prevent"]),style:{"min-height":"200px"}},[t("div",De,[t("div",Pe,[a(U,null,{default:n(({id:I})=>[a(V,null,{default:n(()=>[a(r,{modelValue:w.value,"onUpdate:modelValue":F[0]||(F[0]=x=>w.value=x),attrs:{id:I},searchable:!1,options:b.value,placeholder:S.$t("Select_statements"),valueProp:"id",label:"code",mode:"tags","close-on-select":!1,"append-new-option":!1},null,8,["modelValue","attrs","options","placeholder"])]),_:2},1024)]),_:1}),t("p",Fe,e($(f).applications[0]),1)])])],40,Me)]),action:n(({close:I})=>[a(y,{color:"primary",outlined:"",type:"submit",form:"payment-verify-form"},{default:n(()=>[D(e(S.$t("Save")),1)]),_:1})]),_:1},8,["open","title"])}}}),Ae={class:"applicant-list-wrapper"},Ue={class:"is-size-3 mb-3"},xe=["textContent"],Le=["href"],Be={class:"mr-3"},Te=z({async setup(i){let o,p;const{t:c,locale:P}=R(),d=E().params?.id??null,A=tt(),g=at(),l=_(),b=_(),w={orderNumber:{format:(y,N,I)=>`${I+1}`,cellClass:"is-flex-grow-0"},file:{label:c("Invoice"),grow:!0},amount:{label:c("Amount")},status:{label:c("Status")},created_at:{label:c("Paid_date")},verified_at:{label:c("Verified_date")},actions:{label:c("Actions"),align:"center"}},f=_(!1),h=_(!1);[o,p]=Z(()=>v()),await o,p();async function v(){const y=await kt(Number(d));l.value=await y}async function M(y){b.value=y,f.value=!0}async function S(){h.value=!0}async function F(y){b.value=y,A.$patch({confirmModalState:!0})}async function r(){await Se(d),await v()}async function V(){await Ce(b.value),await v()}function U(){g.success(c("Updated_successfully"))}return(y,N)=>{const I=J,x=T,G=ot,Q=H("VueIconify"),k=xt,nt=Ut,lt=Mt,st=Dt,it=Ie,ct=Ve,rt=At;return s(),m("div",Ae,[a(G,{class:"mb-4","flex-wrap":"wrap"},{default:n(()=>[a(I,null,{default:n(()=>[t("h1",Ue,e(y.$t("Payments")),1)]),_:1}),a(I,{class:"ml-auto"},{default:n(()=>[l.value?.verified_at?C("",!0):(s(),B(x,{key:0,type:"button",rounded:"",color:"primary",icon:"feather:check",onClick:S},{default:n(()=>[D(e(y.$t("Verify_contract")),1)]),_:1}))]),_:1})]),_:1}),a(st,{columns:$(w),data:l.value.payments},{default:n(W=>[a(lt,{rounded:""},{"header-column":n(({column:Y})=>[Y.key==="orderNumber"?(s(),m("span",{key:0,class:"is-flex-grow-0",textContent:e("#")},null,8,xe)):C("",!0)]),"body-cell":n(({row:Y,column:j,value:L})=>[j.key==="file"?(s(),m("a",{key:0,href:Y.file,class:"has-text-primary is-pushed-mobile"},[t("span",Be,e(y.$t("Download")),1),a(Q,{icon:"feather:link"})],8,Le)):C("",!0),j.key==="amount"?(s(),m(O,{key:1},[D(e(Number(L).toLocaleString()),1)],64)):C("",!0),j.key==="status"&&L?(s(),B(k,{key:2,status:L},null,8,["status"])):C("",!0),j.key==="created_at"&&L?(s(),m(O,{key:3},[D(e(y.$h.formatDate(L,"DD.MM.YYYY HH:mm")),1)],64)):C("",!0),j.key==="verified_at"&&L?(s(),m(O,{key:4},[D(e(y.$h.formatDate(L,"DD.MM.YYYY HH:mm")),1)],64)):C("",!0),j.key==="actions"?(s(),m(O,{key:5},[Y.status?.color==="warning"?(s(),B(nt,{key:0},{default:n(()=>[a(x,{class:"is-primary is-outlined px-3",onClick:ut=>M(Y.id)},{default:n(()=>[D(e(y.$t("Verify")),1)]),_:2},1032,["onClick"]),a(x,{class:"is-danger is-outlined px-3",onClick:ut=>F(Y.id)},{default:n(()=>[D(e(y.$t("Cancel")),1)]),_:2},1032,["onClick"])]),_:2},1024)):C("",!0)],64)):C("",!0)]),_:1})]),_:1},8,["columns","data"]),a(it,{modelValue:f.value,"onUpdate:modelValue":N[0]||(N[0]=W=>f.value=W),"payment-id":Number(b.value),"onUpdate:list":N[1]||(N[1]=()=>{v(),U()})},null,8,["modelValue","payment-id"]),a(ct,{modelValue:h.value,"onUpdate:modelValue":N[2]||(N[2]=W=>h.value=W),contract:l.value,onConfirmAction:r},null,8,["modelValue","contract"]),a(rt,{onConfirmAction:V})])}}}),Ye={class:"statement-detail-wrapper"},je={key:0,class:"columns mt-5"},ze={key:1,class:"mt-5"},oa=z({setup(i){const{t:o,locale:p}=R(),c=E(),P=c.params?.id??null,u=_(c.hash.slice(1)||"details"),d=_([{label:o("Contract_details"),value:"details",icon:"lnil lnil-tap"},{label:o("Payment"),value:"payment",icon:"fas fa-tree"}]),A=_(),g=_(),l=_();return It().setPageTitle(o("Contract_card")),bt({title:X(()=>o("Contract_card"))}),$t(async()=>{const w=await Ct(Number(P)),f=await St(Number(P));A.value=w,g.value=f,l.value=f.map((h,v)=>v)}),(w,f)=>{const h=pe,v=dt;return s(),m("div",Ye,[a(v,{selected:u.value,tabs:d.value},{tab:n(({activeValue:M})=>[M==="details"?(s(),m("div",je,[a(h)])):C("",!0),M==="payment"?(s(),m("div",ze,[a(Te)])):C("",!0)]),_:1},8,["selected","tabs"])])}}});export{oa as default};
