import{A as F,N as W,f as d,h as S,bR as z,B as V,bS as G,E as Z,a7 as J,r as Q,bb as ee,o as m,j as k,i as w,l as C,aZ as te,I as ae,ax as le,F as j,v as H,g as O,bf as L,t as K,G as B,m as M,k as D,w as re,U as se,x as oe}from"./index.bb4908f5.js";const P=F({props:{id:{type:String,required:!0},label:{type:String,default:void 0},modelValue:{type:String,default:void 0},noRouter:{type:Boolean,default:void 0},routerQueryKey:{type:String,default:"sort"}},emits:["update:modelValue"],setup(t,r){const l=W(),y=d(()=>t.modelValue??l.query[t.routerQueryKey]??""),v=d(()=>y.value===`${t.id}:asc`),n=d(()=>y.value===`${t.id}:desc`),g=d(()=>v.value?`${t.id}:desc`:n.value?void 0:`${t.id}:asc`),f=d(()=>{if(t.noRouter)return{};const i={...l.query};return t.routerQueryKey&&(i[t.routerQueryKey]=g.value),{name:l.name,params:l.params,query:i}}),_=i=>{if(r.emit("update:modelValue",g.value),t.noRouter)return i.preventDefault(),i.stopPropagation(),!1};return()=>{const i=r.slots?.default?.({isDesc:n.value,isAsc:v.value,nextSort:g.value,value:y.value}),e=S(z,{to:f.value,onClick:_,onKeydown(o){o.code==="Space"&&(o.preventDefault(),o.stopPropagation(),o.target instanceof HTMLAnchorElement&&o.target.dispatchEvent(new MouseEvent("click")))}},{default(){const o=S("span",{key:`${y.value}`,class:"is-inline"},S("span",{class:"ml-3 iconify is-inline","data-icon":v.value?"fa:sort-asc":n.value?"fa:sort-desc":"fa:sort"}));return[i??t.label,o]}});return S("span",{},e)}}}),I=Symbol(),q=t=>t,ne=({key:t,order:r,a:l,b:y})=>{const v=l[t],n=y[t];return typeof v=="string"?r==="asc"?v.localeCompare(n):n.localeCompare(v):v>n?r==="asc"?1:-1:v<n?r==="asc"?-1:1:0},be=F({props:{data:{type:[Array,Function],default:void 0},columns:{type:Object,default:void 0},sort:{type:String,default:void 0},searchTerm:{type:String,default:void 0},limit:{type:Number,default:void 0},page:{type:Number,default:void 0},total:{type:Number,default:void 0},debounceSearch:{type:Number,default:300}},emits:["update:sort","update:page","update:limit","update:searchTerm"],setup(t,r){const l=V(),y=V(!1),v=V(""),n=d({get:()=>t.sort??v.value,set(a){t.sort===void 0?v.value=a:r.emit("update:sort",a)}}),g=V(""),f=d({get:()=>t.searchTerm??g.value,set(a){t.searchTerm===void 0?g.value=a:r.emit("update:searchTerm",a)}}),_=V(1),i=d({get:()=>t.page??_.value,set(a){t.page===void 0?_.value=a:r.emit("update:page",a)}}),e=V(5),o=d({get:()=>Math.max(1,t.limit??e.value),set(a){t.limit===void 0?e.value=a:r.emit("update:limit",a)}}),s=d(()=>{const a=t.columns;if(!a)return a;const p={};return Object.keys(a).reduce((b,u)=>{const c=a[u];return typeof c=="string"?b[u]={format:q,label:c,key:u}:typeof c=="object"&&(b[u]={format:q,label:u,key:u,...c},c.sortable===!0&&(c.renderHeader?b[u].renderHeader=()=>S(P,{id:u,noRouter:!0,modelValue:n.value,"onUpdate:modelValue":h=>n.value=h},{default:c.renderHeader}):b[u].renderHeader=()=>S(P,{id:u,label:c.label??u,noRouter:!0,modelValue:n.value,"onUpdate:modelValue":h=>n.value=h})),c.searchable===!0&&!c.sort&&(b[u].sort=ne)),b},p),p}),U=d(()=>{let a=l.value;if(!a||typeof t.data=="function")return a;if($.value){const p=s.value?Object.values(s.value).filter(b=>!b||typeof b=="string"?!1:b.searchable===!0):[];if(p.length){const b=new RegExp($.value,"i");a=a.filter((u,c)=>p.some(h=>{if(!h.key)return!1;const R=u[h.key];return h.filter?h.filter({searchTerm:$.value,value:R,row:u,column:h,index:c}):typeof R=="string"?R.match(b):!1}))}}return a}),E=d(()=>{let a=U.value;if(!a||typeof t.data=="function")return a;if(n.value&&n.value.includes(":")){const[p,b]=n.value.split(":"),u=s.value?Object.values(s.value).find(c=>!c||typeof c=="string"?!1:c.sortable===!0&&c.key===p):null;if(u){const c=[...a];c.sort((h,R)=>!u.key||!u.sort?0:u.sort({order:b,column:u,key:u.key,a:h,b:R})),a=c}}return a}),X=d(()=>typeof t.data=="function"||!l.value?l.value:E.value?.slice(T.value,T.value+o.value)),$=G(f,t.debounceSearch),x=d(()=>t.total??E.value?.length??0),T=d(()=>(i.value-1)*o.value),Y=d(()=>x.value?Math.ceil(x.value/o.value):0);async function N(a){if(typeof t.data=="function"){y.value=!0;try{l.value=await t.data({searchTerm:$.value,start:T.value,limit:o.value,sort:n.value,controller:a})}finally{y.value=!1}}}Z([$,o],()=>{i.value!==1&&(i.value=1)}),J(async a=>{let p;typeof t.data=="function"?(p=new AbortController,await N(p)):l.value=t.data,a(()=>{p?.abort()})});const A=Q({data:X,columns:s,loading:y,searchInput:f,searchTerm:$,start:T,page:i,limit:o,sort:n,total:x,totalPages:Y,fetchData:N});return ee(I,A),()=>{const a=r.slots.default?.(A);return S("div",{class:"flex-table-wrapper"},a)}}});const ue=["data-th"],ie=F({props:{column:{default:()=>({})}},setup(t){const r=t;return(l,y)=>(m(),k("div",{class:C(["flex-table-cell is-relative",[r.column.bold&&"is-bold",r.column.media&&"is-media",r.column.grow===!0&&"is-grow",r.column.grow==="lg"&&"is-grow-lg",r.column.grow==="xl"&&"is-grow-xl",r.column.scrollX&&!r.column.scrollY&&"has-slimscroll-x",!r.column.scrollX&&r.column.scrollY&&"has-slimscroll",r.column.scrollX&&r.column.scrollY&&"has-slimscroll-all",r.column.align==="end"&&"cell-end",r.column.align==="center"&&"cell-center",r.column.cellClass]]),"data-th":r.column.label||void 0},[w(l.$slots,"default")],10,ue))}});const ce={key:0,class:"flex-table-header"},de=["tabindex","onKeydown","onClick"],fe={key:0},ve={class:"language-json py-4"},me=F({props:{data:{default:()=>[]},columns:{default:void 0},printObjects:{type:Boolean},reactive:{type:Boolean},compact:{type:Boolean},rounded:{type:Boolean},separators:{type:Boolean},clickable:{type:Boolean},subtable:{type:Boolean},noHeader:{type:Boolean}},emits:["rowClick"],setup(t,{emit:r}){const l=t,y=te(I,null),v=d(()=>y?.data?y.data:l.reactive?ae(l.data)?l.data:Q(l.data):le(l.data)),n=f=>f,g=d(()=>{const f=y?.columns??l.columns;let _=[];if(f)for(const[i,e]of Object.entries(f))typeof e=="string"?_.push({format:n,label:e,key:i}):_.push({format:n,label:i,key:i,...e});else if(v.value.length>0)for(const[i]of Object.entries(v.value[0]))_.push({format:n,label:i,key:i});return _});return(f,_)=>{const i=ie;return m(),k("div",{class:C(["flex-table",[l.compact&&"is-compact",l.rounded&&"is-rounded",l.separators&&"with-separators",l.noHeader&&"no-header",l.clickable&&"is-table-clickable",l.subtable&&"sub-table"]])},[w(f.$slots,"header",{},()=>[l.noHeader?M("",!0):(m(),k("div",ce,[(m(!0),k(j,null,H(B(g),e=>w(f.$slots,"header-column",{key:"col"+e.key,column:e},()=>[e.renderHeader?(m(),O(L({render:e.renderHeader}),{key:0,class:C([e.grow===!0&&"is-grow",e.grow==="lg"&&"is-grow-lg",e.grow==="xl"&&"is-grow-xl",e.align==="end"&&"cell-end",e.align==="center"&&"cell-center"])},null,8,["class"])):(m(),k("span",{key:1,class:C([e.grow===!0&&"is-grow",e.grow==="lg"&&"is-grow-lg",e.grow==="xl"&&"is-grow-xl",e.align==="end"&&"cell-end",e.align==="center"&&"cell-center"])},K(e.label),3))])),128))]))]),w(f.$slots,"body",{},()=>[(m(!0),k(j,null,H(B(v),(e,o)=>(m(),k(j,{key:o},[w(f.$slots,"body-row-pre",{row:e,columns:B(g),index:o}),D("div",{class:C(["flex-table-item",[l.clickable&&"is-clickable",e.bg_row&&`has-background-${e.bg_row}-light has-text-dark`]]),tabindex:l.clickable?0:void 0,onKeydown:se(oe(()=>{l.clickable&&r("rowClick",e,o)},["prevent"]),["space"]),onClick:()=>{l.clickable&&r("rowClick",e,o)}},[w(f.$slots,"body-row",{row:e,columns:B(g),index:o},()=>[(m(!0),k(j,null,H(B(g),s=>(m(),O(i,{key:"row"+s.key,column:s},{default:re(()=>[w(f.$slots,"body-cell",{row:e,column:s,index:o,value:s.format(e[s.key],e,o)},()=>[s.renderRow?(m(),O(L({render:()=>s.renderRow?.(e,s,o)}),{key:0})):typeof s.format(e[s.key],e,o)=="object"?(m(),k("span",{key:1,class:C([s.cellClass,s.inverted&&"dark-inverted",!s.inverted&&(s.bold?"dark-text":"")])},[t.printObjects?(m(),k("details",fe,[D("div",ve,[D("pre",null,[D("code",null,K(s.format(e[s.key],e,o)),1)])])])):M("",!0)],2)):(m(),k("span",{key:2,class:C([s.cellClass,s.inverted&&"dark-inverted",!s.inverted&&(s.bold?"dark-text":"")])},K(s.format(e[s.key],e,o)),3))])]),_:2},1032,["column"]))),128))])],42,de),w(f.$slots,"body-row-post",{row:e,columns:B(g),index:o})],64))),128))])],2)}}});export{me as _,be as a};
