import{_ as se,u as ke}from"./VModal.7c3df6a9.js";import{bL as Ce,K as L,r as $,m as Q,p as u,q as B,s as t,y as n,f as e,D as r,M as l,H as q,C as D,V as X,c as K,o as ie,x as k,B as I,i as Y,G as re,F as ee,Q as xe,w as Fe,R as ne,bI as Ue,a0 as Se,bp as Ie,Z as Be,bF as Ee}from"./index.f060b7c6.js";import{_ as W}from"./VField.17e54227.js";import{a as te,_ as H,b as ae}from"./VControl.068ba628.js";import{u as oe}from"./vue-i18n.runtime.esm-bundler.1634ed66.js";import{_ as Re}from"./ConfirmActionModal.dc1a3c08.js";import{_ as de,a as ue}from"./VOption.3e2cc48c.js";import{f as De}from"./index.5dcd36f7.js";import{d as Ne}from"./index.12530604.js";import{_ as Te}from"./VAvatar.8f6c454e.js";import{_ as qe}from"./VIconButton.e183282f.js";import{_ as Ae}from"./VFilePond.ae00fc62.js";import{b as Oe,_ as Pe,a as Me}from"./VFlexTable.4ba052d2.js";import{_ as Le}from"./VFlexPagination.b3a191bb.js";import{_ as je}from"./VDropdown.a61ebde9.js";import{_ as ze}from"./StatusTag.cb3350f7.js";import{_ as Ke}from"./VPlaceholderSection.afc34ed0.js";import{_ as We,a as He}from"./TableActionsBlock.3e62a7b3.js";import{_ as Ge}from"./VCard.fd01a720.js";import{_ as Qe}from"./VFlexItem.3714d147.js";import{_ as Ze}from"./CountrySelect.482e4695.js";import{u as Je}from"./viewWrapper.7134460b.js";import"./via-placeholder.9af8280d.js";import"./VIcon.a5a02b18.js";import"./useDropdown.191976f8.js";import"./VTag.97e5d79c.js";import"./VButtons.eeafcbc5.js";const j=Ce();async function Xe(d){try{const{data:s}=await j({url:`/api/admin/employee?page=${d}`});return s.data}catch(s){throw s}}async function Ye(d){try{const{data:s}=await j({url:`/api/admin/employee/${d}`});return s.data}catch(s){throw s}}async function et(d){try{const{data:s}=await j({url:"/api/admin/employee",method:"POST",data:d});return s.data}catch(s){throw s}}async function tt(d,s){try{const{data:p}=await j({url:`/api/admin/employee/${d}`,method:"POST",data:s})}catch(p){throw p}}async function at(d,s){try{const{data:p}=await j({url:`/api/admin/employee/${d}/pass`,method:"PUT",data:s})}catch(p){throw p}}async function ot(d){try{const{data:s}=await j({url:`/api/admin/employee/${d}`,method:"DELETE"})}catch(s){throw s}}const lt=["onSubmit"],nt={class:"columns is-multiline"},st={class:"column is-6"},it={class:"help has-text-danger"},rt={class:"column is-6"},dt={class:"help has-text-danger"},ut=L({props:{modelValue:Boolean,employeeId:{type:Number,default:null}},emits:["update:modelValue"],setup(d,{emit:s}){const p=d,{t:c}=oe(),f=$(!1),m=$(c("Update_password")),C=$(""),v=$(""),a=Q({password:[],password_confirmation:[]});async function y(b){try{f.value=!0,await at(p.employeeId,{password:C.value,password_confirmation:v.value}),U()}catch(x){S(),Object.assign(a,x.response?.data?.errors)}finally{f.value=!1}}function U(){S(),h(),s("update:modelValue",!1)}function S(){Object.assign(a,{password:[],password_confirmation:[]})}function h(){C.value="",v.value=""}return(b,x)=>{const A=te,N=H,V=W,o=X,z=se;return u(),B(z,{open:d.modelValue,size:"large",title:m.value,actions:"right",onClose:U},{content:t(()=>[n("form",{id:"employee-password-form",class:"modal-form",onSubmit:q(y,["prevent"])},[n("div",nt,[n("div",st,[e(V,{label:b.$t("Password"),required:""},{default:t(()=>[e(N,null,{default:t(()=>[e(A,{type:"password",modelValue:C.value,"onUpdate:modelValue":x[0]||(x[0]=T=>C.value=T)},null,8,["modelValue"]),n("p",it,r(l(a).password[0]),1)]),_:1})]),_:1},8,["label"])]),n("div",rt,[e(V,{label:b.$t("Confirm_password"),required:""},{default:t(()=>[e(N,null,{default:t(()=>[e(A,{type:"password",modelValue:v.value,"onUpdate:modelValue":x[1]||(x[1]=T=>v.value=T)},null,8,["modelValue"]),n("p",dt,r(l(a).password_confirmation[0]),1)]),_:1})]),_:1},8,["label"])])])],40,lt)]),action:t(({close:T})=>[e(o,{loading:f.value,type:"submit",color:"primary",outlined:"",form:"employee-password-form"},{default:t(()=>[D(r(b.$t("Save")),1)]),_:1},8,["loading"])]),_:1},8,["open","title"])}}}),mt={key:0,class:"has-text-danger"},pt=L({props:{modelValue:{default:null},isRequired:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(d,{emit:s}){const p=d,c=$([]),f=K({get:()=>p.modelValue,set:async m=>{s("update:modelValue",m)}});return ie(async()=>{const m=await De();c.value=m}),(m,C)=>{const v=ae,a=de,y=ue,U=H,S=W;return u(),B(S,null,{default:t(()=>[e(v,null,{default:t(()=>[D(r(m.$t("Roles"))+" ",1),d.isRequired?(u(),k("span",mt,"*")):I("",!0)]),_:1}),e(U,null,{default:t(()=>[e(y,{modelValue:l(f),"onUpdate:modelValue":C[0]||(C[0]=h=>Y(f)?f.value=h:null)},{default:t(()=>[e(a,{disabled:"",hidden:"",value:""},{default:t(()=>[D(r(m.$t("Select"))+"...",1)]),_:1}),(u(!0),k(ee,null,re(c.value,h=>(u(),B(a,{key:h.id,value:h.id,textContent:r(h.name)},null,8,["value","textContent"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})}}}),ct={key:0,class:"has-text-danger"},_t=L({props:{modelValue:{default:null},isRequired:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(d,{emit:s}){const p=d,c=$([]),f=K({get:()=>p.modelValue,set:async m=>{s("update:modelValue",m)}});return ie(async()=>{const m=await Ne();c.value=m}),(m,C)=>{const v=ae,a=de,y=ue,U=H,S=W;return u(),B(S,null,{default:t(()=>[e(v,null,{default:t(()=>[D(r(m.$t("Department"))+" ",1),d.isRequired?(u(),k("span",ct,"*")):I("",!0)]),_:1}),e(U,null,{default:t(()=>[e(y,{modelValue:l(f),"onUpdate:modelValue":C[0]||(C[0]=h=>Y(f)?f.value=h:null)},{default:t(()=>[e(a,{disabled:"",hidden:"",value:""},{default:t(()=>[D(r(m.$t("Select"))+"...",1)]),_:1}),(u(!0),k(ee,null,re(c.value,h=>(u(),B(a,{key:h.id,value:h.id,textContent:r(h.name)},null,8,["value","textContent"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})}}});const ft=["onSubmit"],vt={class:"columns is-multiline"},yt={class:"column is-12 has-text-centered fieldset"},Vt=["src"],ht={class:"help has-text-danger"},gt={class:"column is-6"},wt={class:"help has-text-danger"},$t={class:"column is-6"},bt={class:"help has-text-danger"},kt={class:"column is-6"},Ct={class:"help has-text-danger"},xt={class:"column is-6"},Ft={class:"help has-text-danger"},Ut={key:0,class:"column is-6"},St={class:"help has-text-danger"},It={key:1,class:"column is-6"},Bt={class:"help has-text-danger"},Et={class:"column is-6"},Rt={class:"help has-text-danger"},Dt={class:"column is-6"},Nt={class:"help has-text-danger"},Tt=L({props:{modelValue:Boolean,employeeId:{type:Number,default:null}},emits:["update:modelValue","update:list"],setup(d,{emit:s}){const p=d,{t:c}=oe(),f=$(!1),m=$(!1),C=$(c("Add")),v=$(),a=Q({avatar:"",username:"",email:"",firstname:"",lastname:"",password:"",password_confirmation:"",department_id:null,role_id:null}),y=Q({avatar:[],username:[],email:[],firstname:[],lastname:[],password:[],password_confirmation:[],department_id:[],role_id:[]}),U=K(()=>a.avatar||"/images/avatars/svg/vuero-1.svg");Fe(()=>p.employeeId,async V=>{if(!V)Object.assign(a,{});else{const o=await Ye(Number(p.employeeId));Object.assign(a,o)}},{deep:!0,immediate:!0});async function S(V){try{m.value=!0;const o=new FormData;o.append("avatar",v.value||""),o.append("username",a.username),o.append("email",a.email),o.append("firstname",a.firstname),o.append("lastname",a.lastname),o.append("password",a.password),o.append("password_confirmation",a.password_confirmation),o.append("department_id",a.department_id),o.append("role_id",a.role_id),p.employeeId?await tt(p.employeeId,o):await et(o),s("update:list"),x()}catch(o){Object.assign(y,o.response?.data?.errors)}finally{m.value=!1}}const h=V=>{v.value=V.target.files[0]},b=(V,o)=>{if(V){console.error(V);return}a.avatar=void 0};function x(){A(),N(),s("update:modelValue",!1)}function A(){Object.assign(y,{avatar:[],username:[],email:[],firstname:[],lastname:[],password:[],password_confirmation:[],department_id:[],role_id:[]})}function N(){Object.assign(a,{avatar:"",username:"",email:"",firstname:"",lastname:"",password:"",password_confirmation:"",department_id:null,role_id:null})}return(V,o)=>{const z=Ae,T=qe,w=Te,i=te,E=H,R=W,O=_t,P=pt,M=X,Z=se;return u(),B(Z,{open:d.modelValue,size:"large",title:C.value,actions:"right",onClose:x},{content:t(()=>[n("form",{id:"employee-form",class:"modal-form",onSubmit:q(S,["prevent"])},[n("div",vt,[n("div",yt,[e(w,{size:"xl",class:"profile-v-avatar"},{avatar:t(()=>[f.value?(u(),B(z,{key:1,class:"profile-filepond",name:"profile_filepond","chunk-retry-delays":[500,1e3,3e3],"label-idle":"<i class='lnil lnil-cloud-upload'></i>","accepted-file-types":["image/png","image/jpeg","image/gif"],"image-preview-height":140,"image-resize-target-width":140,"image-resize-target-height":140,"image-crop-aspect-ratio":"1:1","style-panel-layout":"compact circle","style-load-indicator-position":"center bottom","style-progress-indicator-position":"right bottom","style-button-remove-item-position":"left bottom","style-button-process-item-position":"right bottom",onChange:h,onRemovefile:b})):(u(),k("img",{key:0,class:"avatar",src:l(U),alt:"Employee avatar"},null,8,Vt)),f.value?(u(),B(T,{key:3,icon:"feather:arrow-left",class:"edit-button is-back",circle:"",tabindex:"0",onKeydown:o[2]||(o[2]=ne(q(_=>f.value=!1,["prevent"]),["space"])),onClick:o[3]||(o[3]=_=>f.value=!1)})):(u(),B(T,{key:2,icon:"feather:edit-2",class:"edit-button is-edit",circle:"",tabindex:"0",onKeydown:o[0]||(o[0]=ne(q(_=>f.value=!0,["prevent"]),["space"])),onClick:o[1]||(o[1]=_=>f.value=!0)}))]),_:1}),n("p",ht,r(l(y).avatar[0]),1)]),n("div",gt,[e(R,{label:V.$t("Username"),required:""},{default:t(()=>[e(E,null,{default:t(()=>[e(i,{type:"text",modelValue:l(a).username,"onUpdate:modelValue":o[4]||(o[4]=_=>l(a).username=_)},null,8,["modelValue"]),n("p",wt,r(l(y).username[0]),1)]),_:1})]),_:1},8,["label"])]),n("div",$t,[e(R,{label:V.$t("Email"),required:""},{default:t(()=>[e(E,null,{default:t(()=>[e(i,{type:"text",modelValue:l(a).email,"onUpdate:modelValue":o[5]||(o[5]=_=>l(a).email=_)},null,8,["modelValue"]),n("p",bt,r(l(y).email[0]),1)]),_:1})]),_:1},8,["label"])]),n("div",kt,[e(R,{label:V.$t("First_name"),required:""},{default:t(()=>[e(E,null,{default:t(()=>[e(i,{type:"text",modelValue:l(a).firstname,"onUpdate:modelValue":o[6]||(o[6]=_=>l(a).firstname=_)},null,8,["modelValue"]),n("p",Ct,r(l(y).firstname[0]),1)]),_:1})]),_:1},8,["label"])]),n("div",xt,[e(R,{label:V.$t("Last_name")},{default:t(()=>[e(E,null,{default:t(()=>[e(i,{type:"text",modelValue:l(a).lastname,"onUpdate:modelValue":o[7]||(o[7]=_=>l(a).lastname=_)},null,8,["modelValue"]),n("p",Ft,r(l(y).lastname[0]),1)]),_:1})]),_:1},8,["label"])]),d.employeeId?I("",!0):(u(),k("div",Ut,[e(R,{label:V.$t("Password"),required:""},{default:t(()=>[e(E,null,{default:t(()=>[e(i,{type:"password",modelValue:l(a).password,"onUpdate:modelValue":o[8]||(o[8]=_=>l(a).password=_)},null,8,["modelValue"]),n("p",St,r(l(y).password[0]),1)]),_:1})]),_:1},8,["label"])])),d.employeeId?I("",!0):(u(),k("div",It,[e(R,{label:V.$t("Confirm_password"),required:""},{default:t(()=>[e(E,null,{default:t(()=>[e(i,{type:"password",modelValue:l(a).password_confirmation,"onUpdate:modelValue":o[9]||(o[9]=_=>l(a).password_confirmation=_)},null,8,["modelValue"]),n("p",Bt,r(l(y).password_confirmation[0]),1)]),_:1})]),_:1},8,["label"])])),n("div",Et,[e(O,{modelValue:l(a).department_id,"onUpdate:modelValue":o[10]||(o[10]=_=>l(a).department_id=_),"is-required":""},null,8,["modelValue"]),n("p",Rt,r(l(y).department_id[0]),1)]),n("div",Dt,[e(P,{modelValue:l(a).role_id,"onUpdate:modelValue":o[11]||(o[11]=_=>l(a).role_id=_),"is-required":""},null,8,["modelValue"]),n("p",Nt,r(l(y).role_id[0]),1)])])],40,ft)]),action:t(({close:_})=>[e(M,{loading:m.value,type:"submit",color:"primary",outlined:"",form:"employee-form"},{default:t(()=>[D(r(V.$t("Save")),1)]),_:1},8,["loading"])]),_:1},8,["open","title"])}}}),qt=xe(Tt,[["__scopeId","data-v-75b806ec"]]),At=["onClick"],Ot=n("div",{class:"icon"},[n("i",{"aria-hidden":"true",class:"lnil lnil-pencil"})],-1),Pt={class:"meta"},Mt=["onClick"],Lt=n("div",{class:"icon"},[n("i",{class:"lnir lnir-key","aria-hidden":"true"})],-1),jt={class:"meta"},zt=n("hr",{class:"dropdown-divider"},null,-1),Kt=["onClick"],Wt=n("div",{class:"icon"},[n("i",{class:"lnir lnir-trash","aria-hidden":"true"})],-1),Ht={class:"meta"},Gt=L({emits:["edit","update:password","remove"],setup(d,{emit:s}){return(p,c)=>{const f=je;return u(),B(f,{icon:"feather:more-vertical",class:"is-pushed-mobile",spaced:"",right:""},{content:t(({close:m})=>[n("a",{role:"menuitem",href:"#",class:"dropdown-item is-media",onClick:q(()=>{s("edit"),m()},["prevent"])},[Ot,n("div",Pt,[n("span",null,r(p.$t("Edit")),1)])],8,At),n("a",{role:"menuitem",href:"#",class:"dropdown-item is-media",onClick:q(()=>{s("update:password"),m()},["prevent"])},[Lt,n("div",jt,[n("span",null,r(p.$t("Change_password")),1)])],8,Mt),zt,n("a",{role:"menuitem",href:"#",class:"dropdown-item is-media",onClick:q(()=>{s("remove"),m()},["prevent"])},[Wt,n("div",Ht,[n("span",null,r(p.$t("Remove")),1)])],8,Kt)]),_:1})}}}),Qt={class:"applicant-list-wrapper"},Zt={class:"mb-5"},Jt={class:"title is-5 mb-2"},Xt={class:"columns is-desktop"},Yt=["textContent"],ea={key:0,class:"flex-list-inner"},ta={key:0,class:"is-capitalized"},aa={key:1,class:"is-capitalized"},oa={key:2},Ea=L({async setup(d){let s,p;const{t:c,locale:f}=oe();Ue({title:c("Employees")+" - Nefrit"});const m=ke();Je().setPageTitle(c("Employees_List"));const v=Q({pagination:{current_page:1,per_page:10,total:10},result:[]}),a=$({applicantUser:"Abdullaev Baxrom"}),y=$(!1),U=$(!1),S=$(!1),h=$([]);K(()=>v.result.length===h.value.length),Se();const b=$(),x=K({get:()=>v.pagination.current_page,set:async w=>{await N(w)}}),A={orderNumber:{format:(w,i,E)=>`${E+1}`,cellClass:"is-flex-grow-0"},name:{label:c("Employee_name"),searchable:!0},department:{label:c("Department"),grow:!0,searchable:!0},role:{label:c("Role"),searchable:!0},actions:{label:c("Actions"),align:"center"}};[s,p]=Ie(()=>N()),await s,p();async function N(w=1){const i=await Xe(w);Object.assign(v,i)}function V(w){b.value=w,y.value=!0}async function o(w){b.value=w,m.$patch({confirmModalState:!0})}async function z(){await ot(b.value),N()}async function T(w){console.log({id:w}),b.value=w,U.value=!0}return(w,i)=>{const E=We,R=ae,O=te,P=H,M=W,Z=Ze,_=X,me=Qe,pe=Oe,ce=Ge,_e=He,fe=Ke,ve=ze,ye=Gt,Ve=Pe,he=Le,ge=Me,we=qt,$e=Re,be=ut;return u(),k("div",Qt,[e(E,{center:"",title:"","remove-disabled":!0,onAdd:i[0]||(i[0]=g=>V(null)),onFilter:i[1]||(i[1]=g=>S.value=!S.value)}),Be(n("div",Zt,[e(ce,{radius:"small"},{default:t(()=>[n("h3",Jt,r(l(c)("Filter_form")),1),n("div",Xt,[e(M,{class:"column"},{default:t(()=>[e(R,null,{default:t(()=>[D(r(l(c)("Boss_name")),1)]),_:1}),e(P,null,{default:t(()=>[e(O,{modelValue:a.value.applicantBossName,"onUpdate:modelValue":i[2]||(i[2]=g=>a.value.applicantBossName=g),type:"text",placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(M,{class:"column"},{default:t(()=>[e(R,null,{default:t(()=>[D(r(l(c)("Applicant_name")),1)]),_:1}),e(P,null,{default:t(()=>[e(O,{modelValue:a.value.applicantName,"onUpdate:modelValue":i[3]||(i[3]=g=>a.value.applicantName=g),type:"text",placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(M,{class:"column"},{default:t(()=>[e(R,null,{default:t(()=>[D(r(l(c)("Status")),1)]),_:1}),e(P,null,{default:t(()=>[e(O,{modelValue:a.value.applicantStatus,"onUpdate:modelValue":i[4]||(i[4]=g=>a.value.applicantStatus=g),type:"text",placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),e(Z,{modelValue:a.value.applicantsCountry,"onUpdate:modelValue":i[5]||(i[5]=g=>a.value.applicantsCountry=g),class:"column"},null,8,["modelValue"])]),e(pe,null,{default:t(()=>[e(me,{class:"ml-auto"},{default:t(()=>[e(_,{outlined:"",color:"warning",icon:"feather:filter"},{default:t(()=>[D(r(l(c)("Filter")),1)]),_:1})]),_:1})]),_:1})]),_:1})],512),[[Ee,S.value]]),e(ge,{columns:l(A),data:l(v).result,limit:l(v).pagination.per_page,total:l(v).pagination.total},{default:t(g=>[e(_e,null,{left:t(()=>[e(M,null,{default:t(()=>[e(P,{icon:"feather:search"},{default:t(()=>[e(O,{modelValue:g.searchInput,"onUpdate:modelValue":F=>g.searchInput=F,class:"is-rounded",placeholder:l(c)("Search")+"..."},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1024)]),_:2},1024)]),_:2},1024),e(Ve,{rounded:""},{"header-column":t(({column:F})=>[F.key==="orderNumber"?(u(),k("span",{key:0,class:"is-flex-grow-0",textContent:r("#")},null,8,Yt)):I("",!0)]),body:t(()=>[l(v).result.length===0?(u(),k("div",ea,[e(fe,{title:w.$t("No_data"),subtitle:w.$t("There_is_no_data_that_match_your_query"),class:"my-6"},null,8,["title","subtitle"])])):I("",!0)]),"body-cell":t(({row:F,column:G,value:J,index:la})=>[G.key==="status"&&J?(u(),B(ve,{key:0,status:J},null,8,["status"])):I("",!0),G.key==="name"?(u(),k(ee,{key:1},[F.firstname?(u(),k("span",ta,r(F.firstname)+"\xA0",1)):I("",!0),F.lastname?(u(),k("span",aa,r(F.lastname),1)):I("",!0)],64)):I("",!0),G.key==="role"?(u(),k("span",oa,r(J.name),1)):I("",!0),G.key==="actions"?(u(),B(ye,{key:3,onEdit:le=>V(F.id),"onUpdate:password":le=>T(F.id),onRemove:le=>o(F.id)},null,8,["onEdit","onUpdate:password","onRemove"])):I("",!0)]),_:1}),e(he,{"current-page":l(x),"onUpdate:current-page":i[6]||(i[6]=F=>Y(x)?x.value=F:null),class:"mt-6","item-per-page":l(v).pagination.per_page,"total-items":l(v).pagination.total},null,8,["current-page","item-per-page","total-items"])]),_:1},8,["columns","data","limit","total"]),e(we,{modelValue:y.value,"onUpdate:modelValue":i[7]||(i[7]=g=>y.value=g),"employee-id":Number(b.value),"onUpdate:list":i[8]||(i[8]=()=>{N(),b.value=null}),onClose:i[9]||(i[9]=g=>b.value=null)},null,8,["modelValue","employee-id"]),e($e,{onConfirmAction:z}),e(be,{modelValue:U.value,"onUpdate:modelValue":i[10]||(i[10]=g=>U.value=g),"employee-id":Number(b.value)},null,8,["modelValue","employee-id"])])}}});export{Ea as default};
