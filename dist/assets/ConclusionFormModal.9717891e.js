import{_ as j}from"./VModal.7c3df6a9.js";import{K as R,c as Y,p as w,q as A,s as l,f as a,C as E,D as h,M as m,y as i,A as Z,i as ee,x as te,G as ae,F as se,r as _,bp as L,m as z,w as T,H as G,V as H}from"./index.f060b7c6.js";import{_ as K}from"./VTextarea.61bc0f20.js";import{_ as k}from"./VField.17e54227.js";import{b as oe,_ as M,a as le}from"./VControl.068ba628.js";import{u as O}from"./vue-i18n.runtime.esm-bundler.1634ed66.js";import{k as ne,l as ie,m as ue,n as de,o as ce,p as re,q as me,s as pe}from"./index.fc264705.js";import{_ as _e}from"./VFileInput.5ba11aca.js";import{_ as fe,a as ve}from"./VOption.3e2cc48c.js";const J=R({props:{modelValue:{default:""},isRequired:{type:Boolean,default:!1},list:null},emits:["update:modelValue"],setup(b,{emit:$}){const f=b,{t:y}=O(),u=Y({get:()=>f.modelValue,set:async V=>{$("update:modelValue",V)}});return(V,g)=>{const v=oe,d=fe,r=ve,n=M,x=k;return w(),A(x,null,{default:l(()=>[a(v,null,{default:l(()=>[E(h(m(y)("Status"))+" ",1),i("span",{class:Z({"has-text-danger":b.isRequired})},"*",2)]),_:1}),a(n,null,{default:l(()=>[a(r,{modelValue:m(u),"onUpdate:modelValue":g[0]||(g[0]=s=>ee(u)?u.value=s:null)},{default:l(()=>[a(d,{disabled:"",hidden:"",value:""},{default:l(()=>[E(h(m(y)("Select"))+" ...",1)]),_:1}),(w(!0),te(se,null,ae(b.list,s=>(w(),A(d,{key:s.id,value:s.id,textContent:h(s.name)},null,8,["value","textContent"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})}}}),Ve=["onSubmit"],ge={class:"columns is-multiline"},he={class:"column is-12"},be={class:"help has-text-danger"},xe={class:"column is-12"},Se={class:"help has-text-danger"},ye={class:"column is-12"},Ie={class:"help has-text-danger"},Le=R({props:{modelValue:Boolean,itemId:{type:Number,default:null},parentId:{type:Number,default:null}},emits:["update:modelValue","update:list"],async setup(b,{emit:$}){let f,y;const u=b,{t:V}=O();let g=_(V("Add"));const v=_(!1),d=_(""),r=_(""),n=_(),x=([f,y]=L(()=>ne()),f=await f,y(),f),s=z({message:"",text:"",status_id:""});T(()=>u.itemId,async p=>{if(!p)g.value=V("Add"),d.value="",r.value="",n.value="";else{g.value=V("Edit");const t=await ie(Number(u.itemId));d.value=t.message,r.value=t.text,n.value=t.status?.id}},{deep:!0,immediate:!0});async function U(p){try{v.value=!0;const t={message:d.value,text:r.value,application_id:u.parentId,status_id:n.value};u.itemId?await ue(u.itemId,t):await de(t),$("update:list"),S()}catch(t){Object.assign(s,t.response?.data?.errors)}finally{v.value=!1}}function S(){d.value="",r.value="",n.value="",Object.assign(s,{message:"",text:"",status_id:""}),$("update:modelValue",!1)}function N(p){s[p.target.name]=""}return(p,t)=>{const D=le,B=M,F=k,o=K,e=J,c=H,C=j;return w(),A(C,{open:b.modelValue,size:"large",title:m(g),actions:"right",onClose:S},{content:l(()=>[i("form",{id:"notice-form",class:"modal-form",onSubmit:G(U,["prevent"])},[i("div",ge,[i("div",he,[a(F,{label:p.$t("Notice_message"),required:""},{default:l(()=>[a(B,null,{default:l(()=>[a(D,{name:"message",modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=I=>d.value=I),onInput:N},null,8,["modelValue"]),i("p",be,h(m(s).message[0]),1)]),_:1})]),_:1},8,["label"])]),i("div",xe,[a(F,{label:p.$t("Notice_details"),required:""},{default:l(()=>[a(B,null,{default:l(()=>[a(o,{name:"text",placeholder:p.$t("Add_text"),modelValue:r.value,"onUpdate:modelValue":t[1]||(t[1]=I=>r.value=I),onInput:N},null,8,["placeholder","modelValue"]),i("p",Se,h(m(s).text[0]),1)]),_:1})]),_:1},8,["label"])]),i("div",ye,[a(e,{name:"status_id",modelValue:n.value,"onUpdate:modelValue":t[2]||(t[2]=I=>n.value=I),list:m(x),"is-required":!0,onChange:N},null,8,["modelValue","list"]),i("p",Ie,h(m(s).status_id[0]),1)])])],40,Ve)]),action:l(({close:I})=>[a(c,{loading:v.value,color:"primary",outlined:"",type:"submit",form:"notice-form",disabled:v.value},{default:l(()=>[E(h(p.$t("Save")),1)]),_:1},8,["loading","disabled"])]),_:1},8,["open","title"])}}}),$e=["onSubmit"],Ce={class:"columns is-multiline"},Ne={class:"column is-12"},we={class:"help has-text-danger"},Be={class:"column is-12"},Fe={class:"help has-text-danger"},qe={class:"column is-12"},ze=R({props:{modelValue:Boolean,itemId:{type:Number,default:null},parentId:{type:Number,default:null}},emits:["update:modelValue","update:list"],async setup(b,{emit:$}){let f,y;const u=b,{t:V}=O();let g=_(V("Add"));const v=_(!1),d=_(""),r=_(),n=_([]),x=_([]),s=_([]),U=([f,y]=L(()=>ce()),f=await f,y(),f),S=z({text:"",status_id:""});T(()=>u.itemId,async(o,e)=>{if(o){g.value=V("Edit");const c=await re(Number(u.itemId));d.value=c.text,r.value=c.status?.id,x.value=c.files}},{deep:!0,immediate:!0});async function N(o){try{v.value=!0;const e={text:d.value,application_id:u.parentId,status_id:r.value,files:n.value,removed_files:s.value},c=new FormData;c.append("text",e.text),c.append("application_id",e.application_id),c.append("status_id",e.status_id),n.value.forEach(C=>{c.append("files[]",C)}),s.value.forEach(C=>{c.append("removes[]",C)}),u.itemId?await me(u.itemId,c):await pe(c),$("update:list"),p()}catch(e){Object.assign(S,e.response?.data?.errors)}finally{v.value=!1}}function p(){g.value=V("Add"),d.value="",r.value="",n.value=[],x.value=[],s.value=[],Object.assign(S,{text:"",status_id:""}),$("update:modelValue",!1)}function t(o){S[o.target.name]=""}function D(o){const e=o.target;console.log("files: ",e.files),e.files&&n.value?.push(e.files[0])}function B(o){n.value=n.value?.filter(e=>e.lastModified!==o)}function F(o){s.value.push(o),x.value=x.value?.filter(e=>e.id!==o)}return(o,e)=>{const c=K,C=M,I=k,P=J,Q=_e,W=H,X=j;return w(),A(X,{open:b.modelValue,size:"large",title:m(g),actions:"right",onClose:p},{content:l(()=>[i("form",{id:"conclusion-form",class:"modal-form",onSubmit:G(N,["prevent"])},[i("div",Ce,[i("div",Ne,[a(I,{label:o.$t("conclusion_in_details"),required:""},{default:l(()=>[a(C,{"has-error":m(S).text[0]},{default:l(()=>[a(c,{name:"text",placeholder:o.$t("Add_text"),modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=q=>d.value=q),onInput:t},null,8,["placeholder","modelValue"]),i("p",we,h(m(S).text[0]),1)]),_:1},8,["has-error"])]),_:1},8,["label"])]),i("div",Be,[a(P,{name:"status_id",modelValue:r.value,"onUpdate:modelValue":e[1]||(e[1]=q=>r.value=q),list:m(U),"is-required":!0,onChange:t},null,8,["modelValue","list"]),i("p",Fe,h(m(S).status_id[0]),1)]),i("div",qe,[a(Q,{files:n.value,"remote-files":x.value,onFileUpload:D,onFileRemove:B,onRemoteFileRemove:F,"error-message":""},null,8,["files","remote-files"])])])],40,$e)]),action:l(({close:q})=>[a(W,{loading:v.value,color:"primary",outlined:"",type:"submit",form:"conclusion-form",disabled:v.value},{default:l(()=>[E(h(o.$t("Save")),1)]),_:1},8,["loading","disabled"])]),_:1},8,["open","title"])}}});export{ze as _,Le as a,J as b};
