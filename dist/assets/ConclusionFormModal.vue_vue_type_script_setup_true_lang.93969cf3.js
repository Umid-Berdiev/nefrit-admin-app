import{_ as q}from"./VModal.vue_vue_type_style_index_0_lang.2d388967.js";import{z as D,N as U,A as c,bv as j,r as M,D as O,o as z,f as L,w as r,j as o,q as n,t as x,E as v,v as R,m as T,a4 as Y,a2 as k,a3 as G,P as H}from"./index.5f12676e.js";import{_ as J}from"./StatusSelect.vue_vue_type_script_setup_true_lang.f678e129.js";import{_ as K}from"./VTextarea.11bca739.js";import{G as Z,H as ee,I as te,J as ae,K as se,L as oe,M as le,N as ne}from"./index.435422da.js";import{_ as ie}from"./VFileInput.vue_vue_type_script_setup_true_lang.93612086.js";const ue=["onSubmit"],de={class:"columns is-multiline"},ce={class:"column is-12"},re={class:"help has-text-danger"},me={class:"column is-12"},pe={class:"help has-text-danger"},_e={class:"column is-12"},fe={class:"help has-text-danger"},Be=D({props:{modelValue:Boolean,itemId:{type:Number,default:null},parentId:{type:Number,default:null}},emits:["update:modelValue","update:list"],async setup(y,{emit:$}){let _,N;const m=y,{t:g}=U();let b=c(g("Add"));const f=c(!1),i=c(""),u=c(""),l=c(),I=([_,N]=j(()=>ee()),_=await _,N(),_),p=M({message:"",text:"",status_id:""});O(()=>m.itemId,async d=>{if(!d)b.value=g("Add"),i.value="",u.value="",l.value="";else{b.value=g("Edit");const t=await Z(Number(m.itemId));i.value=t.message,u.value=t.text,l.value=t.status?.id}},{deep:!0,immediate:!0});async function A(d){try{f.value=!0;const t={message:i.value,text:u.value,application_id:m.parentId,status_id:l.value};m.itemId?await te(m.itemId,t):await ae(t),$("update:list"),h()}catch(t){Object.assign(p,t.response?.data?.errors)}finally{f.value=!1}}function h(){i.value="",u.value="",l.value="",Object.assign(p,{message:"",text:"",status_id:""}),$("update:modelValue",!1)}function w(d){p[d.target.name]=""}return(d,t)=>{const E=Y,C=k,B=G,a=K,e=J,s=H,S=q;return z(),L(S,{open:y.modelValue,size:"large",title:v(b),actions:"right",onClose:h},{content:r(()=>[o("form",{id:"notice-form",class:"modal-form",onSubmit:R(A,["prevent"])},[o("div",de,[o("div",ce,[n(B,{label:d.$t("Notice_message"),required:""},{default:r(()=>[n(C,null,{default:r(()=>[n(E,{name:"message",modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=V=>i.value=V),onInput:w},null,8,["modelValue"]),o("p",re,x(v(p).message[0]),1)]),_:1})]),_:1},8,["label"])]),o("div",me,[n(B,{label:d.$t("Notice_details"),required:""},{default:r(()=>[n(C,null,{default:r(()=>[n(a,{name:"text",placeholder:d.$t("Add_text"),modelValue:u.value,"onUpdate:modelValue":t[1]||(t[1]=V=>u.value=V),onInput:w},null,8,["placeholder","modelValue"]),o("p",pe,x(v(p).text[0]),1)]),_:1})]),_:1},8,["label"])]),o("div",_e,[n(e,{name:"status_id",modelValue:l.value,"onUpdate:modelValue":t[2]||(t[2]=V=>l.value=V),list:v(I),"is-required":!0,onChange:w},null,8,["modelValue","list"]),o("p",fe,x(v(p).status_id[0]),1)])])],40,ue)]),action:r(({close:V})=>[n(s,{loading:f.value,color:"primary",outlined:"",type:"submit",form:"notice-form",disabled:f.value},{default:r(()=>[T(x(d.$t("Save")),1)]),_:1},8,["loading","disabled"])]),_:1},8,["open","title"])}}}),ve=["onSubmit"],he={class:"columns is-multiline"},Ve={class:"column is-12"},ge={class:"help has-text-danger"},be={class:"column is-12"},Ie={class:"help has-text-danger"},Se={class:"column is-12"},Fe=D({props:{modelValue:Boolean,itemId:{type:Number,default:null},parentId:{type:Number,default:null}},emits:["update:modelValue","update:list"],async setup(y,{emit:$}){let _,N;const m=y,{t:g}=U();let b=c(g("Add"));const f=c(!1),i=c(""),u=c(),l=c([]),I=c([]),p=c([]),A=([_,N]=j(()=>oe()),_=await _,N(),_),h=M({text:"",status_id:""});O(()=>m.itemId,async(a,e)=>{if(a){b.value=g("Edit");const s=await se(Number(m.itemId));i.value=s.text,u.value=s.status?.id,I.value=s.files}},{deep:!0,immediate:!0});async function w(a){try{f.value=!0;const e={text:i.value,application_id:m.parentId,status_id:u.value,files:l.value,removed_files:p.value},s=new FormData;s.append("text",e.text),s.append("application_id",e.application_id),s.append("status_id",e.status_id),l.value.forEach(S=>{s.append("files[]",S)}),p.value.forEach(S=>{s.append("removes[]",S)}),m.itemId?await le(m.itemId,s):await ne(s),$("update:list"),d()}catch(e){Object.assign(h,e.response?.data?.errors)}finally{f.value=!1}}function d(){b.value=g("Add"),i.value="",u.value="",l.value=[],I.value=[],p.value=[],Object.assign(h,{text:"",status_id:""}),$("update:modelValue",!1)}function t(a){h[a.target.name]=""}function E(a){const e=a.target;e.files&&l.value?.push(e.files[0])}function C(a){l.value=l.value?.filter(e=>e.lastModified!==a)}function B(a){p.value.push(a),I.value=I.value?.filter(e=>e.id!==a)}return(a,e)=>{const s=K,S=k,V=G,P=J,Q=ie,W=H,X=q;return z(),L(X,{open:y.modelValue,size:"large",title:v(b),actions:"right",onClose:d},{content:r(()=>[o("form",{id:"conclusion-form",class:"modal-form",onSubmit:R(w,["prevent"])},[o("div",he,[o("div",Ve,[n(V,{label:a.$t("conclusion_in_details"),required:""},{default:r(()=>[n(S,null,{default:r(()=>[n(s,{name:"text",placeholder:a.$t("Add_text"),modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=F=>i.value=F),onInput:t},null,8,["placeholder","modelValue"]),o("p",ge,x(v(h).text[0]),1)]),_:1})]),_:1},8,["label"])]),o("div",be,[n(P,{name:"status_id",modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=F=>u.value=F),list:v(A),"is-required":!0,onChange:t},null,8,["modelValue","list"]),o("p",Ie,x(v(h).status_id[0]),1)]),o("div",Se,[n(Q,{files:l.value,"remote-files":I.value,onFileUpload:E,onFileRemove:C,onRemoteFileRemove:B,"error-message":""},null,8,["files","remote-files"])])])],40,ve)]),action:r(({close:F})=>[n(W,{loading:f.value,color:"primary",outlined:"",type:"submit",form:"conclusion-form",disabled:f.value},{default:r(()=>[T(x(a.$t("Save")),1)]),_:1},8,["loading","disabled"])]),_:1},8,["open","title"])}}});export{Be as _,Fe as a};
