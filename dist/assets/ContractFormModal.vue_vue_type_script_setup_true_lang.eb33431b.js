import{_ as L}from"./VModal.vue_vue_type_style_index_0_lang.da2dcaa5.js";import{z as q,V as x,A as p,r as B,B as E,D as j,p as P,o as k,f as z,w as i,j as o,q as n,E as l,t as _,v as R,m as T,a1 as G,a0 as H,$ as J,P as K}from"./index.da6b4d71.js";import{_ as Q}from"./VFileInput.vue_vue_type_script_setup_true_lang.a8eb15b2.js";import{h as W,u as X,i as Y}from"./index.923abac0.js";import{e as Z,g as ee}from"./index.b555e611.js";const te=["onSubmit"],ae={class:"columns is-multiline"},le={class:"column is-12"},ne={class:"help has-text-danger"},oe={class:"column is-12"},se={class:"help has-text-danger"},ie={class:"column is-12"},de={class:"help has-text-danger"},me={class:"column is-12"},ce={class:"help has-text-danger"},ue={class:"column is-12"},ge=q({props:{modelValue:Boolean,itemId:{type:Number,default:null}},emits:["update:modelValue","update:list"],setup(g,{emit:V}){const r=g,{t:y,locale:N}=x();let h=p(y("Add"));const c=p([]),I=p(),S=p(),a=B({legal_entity_id:null,name:"",payment_amount:0,template_file:"",applications:[]}),f=p([]),m=B({name:"",payment_amount:"",template_file:"",legal_entity_id:"",applications:""}),v=p(!1);E(async()=>{const t=await Z(N.value);I.value=t}),j(()=>r.itemId,async(t,e)=>{if(t){h.value=y("Edit");const s=await W(Number(r.itemId));Object.assign(a,s),f.value=s.applications.map(u=>u.id)}},{deep:!0,immediate:!0}),j(()=>a.legal_entity_id,async(t,e)=>{if(a.applications=[],t){const s=await ee(Number(t));S.value=s}},{deep:!0,immediate:!0});async function O(t){try{v.value=!0;const e=new FormData;e.append("name",a.name),e.append("payment_amount",a.payment_amount),e.append("template_file",c.value.length?c.value[0]:""),e.append("legal_entity_id",a.legal_entity_id),f.value.forEach(s=>{e.append("applications[]",s)}),r.itemId?await X(r.itemId,e):await Y(e),V("update:list"),C()}catch(e){Object.assign(m,e.response?.data?.errors)}finally{v.value=!1}}function C(){r.itemId||(h.value=y("Add"),c.value=[],Object.assign(a,{legal_entity_id:null,name:"",payment_amount:0,template_file:"",applications:[]}),Object.assign(m,{name:"",payment_amount:"",template_file:"",applications:"",legal_entity_id:""})),V("update:modelValue",!1)}function A(t){const e=t.target;console.log("files: ",e.files),c.value=e.files&&[e.files[0]]}function F(t){c.value=[]}return(t,e)=>{const s=G,u=H,$=P("Multiselect"),w=J,M=Q,U=K,D=L;return k(),z(D,{open:g.modelValue,size:"large",title:l(h),actions:"right",onClose:C},{content:i(()=>[o("form",{id:"contract-form",class:"modal-form",onSubmit:R(O,["prevent"])},[o("div",ae,[o("div",le,[n(u,{label:t.$t("Contract_name"),required:""},{default:i(()=>[n(s,{modelValue:l(a).name,"onUpdate:modelValue":e[0]||(e[0]=d=>l(a).name=d)},null,8,["modelValue"]),o("p",ne,_(l(m).name[0]),1)]),_:1},8,["label"])]),o("div",oe,[n(u,{label:t.$t("Contract_amount"),required:""},{default:i(()=>[n(s,{type:"number",modelValue:l(a).payment_amount,"onUpdate:modelValue":e[1]||(e[1]=d=>l(a).payment_amount=d)},null,8,["modelValue"]),o("p",se,_(l(m).payment_amount[0]),1)]),_:1},8,["label"])]),o("div",ie,[n(u,null,{default:i(({id:d})=>[n(w,null,{default:i(()=>[n($,{modelValue:l(a).legal_entity_id,"onUpdate:modelValue":e[2]||(e[2]=b=>l(a).legal_entity_id=b),attrs:{id:d},searchable:!0,options:I.value,placeholder:t.$t("Select_applicant"),valueProp:"id",label:"name",disabled:Boolean(g.itemId)},null,8,["modelValue","attrs","options","placeholder","disabled"])]),_:2},1024)]),_:1}),o("p",de,_(l(m).legal_entity_id[0]),1)]),o("div",me,[n(u,null,{default:i(({id:d})=>[n(w,null,{default:i(()=>[n($,{modelValue:f.value,"onUpdate:modelValue":e[3]||(e[3]=b=>f.value=b),attrs:{id:d},searchable:!1,options:S.value,placeholder:t.$t("Select_statements"),valueProp:"id",label:"code",mode:"tags","close-on-select":!1,disabled:!l(a).legal_entity_id},null,8,["modelValue","attrs","options","placeholder","disabled"])]),_:2},1024)]),_:1}),o("p",ce,_(l(m).applications[0]),1)]),o("div",ue,[n(M,{onFileUpload:A,onFileRemove:F,"error-message":l(m).template_file[0],files:c.value,"remote-files":[]},null,8,["error-message","files"])])])],40,te)]),action:i(({close:d})=>[n(U,{loading:v.value,color:"primary",outlined:"",type:"submit",form:"contract-form",disabled:v.value},{default:i(()=>[T(_(t.$t("Save")),1)]),_:1},8,["loading","disabled"])]),_:1},8,["open","title"])}}});export{ge as _};
