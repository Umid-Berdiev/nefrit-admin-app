import{_ as ft}from"./VTabs.vue_vue_type_script_setup_true_lang.2db41dad.js";import{_ as ct}from"./ConfirmActionModal.vue_vue_type_script_setup_true_lang.1839e1c7.js";import{_ as nt}from"./VModal.vue_vue_type_style_index_0_lang.d48b6f13.js";import{z as j,e as lt,o as l,f as A,w as s,q as a,j as t,t as e,i as d,l as g,m as I,E as f,P as L,ag as pt,N as q,M as J,A as m,r as ht,bv as st,p as Q,v as rt,a2 as yt,a3 as vt,a as ut,b as dt,F as E,s as bt,Q as $t,O as gt,B as wt}from"./index.7188baae.js";import{_ as Vt}from"./VPlaceholderSection.vue_vue_type_style_index_0_lang.034c427f.js";import{u as it}from"./index.43a37110.js";import{_ as kt,a as Ct}from"./VFlexTable.vue_vue_type_style_index_0_lang.693307de.js";import{_ as St}from"./VButtons.vue_vue_type_script_setup_true_lang.bdc7c62b.js";import{_ as Nt}from"./StatusTag.vue_vue_type_script_setup_true_lang.5fd0b8a1.js";import{_ as mt}from"./VFlex.vue_vue_type_style_index_0_lang.da5ac0a5.js";import{_ as ot}from"./VFlexItem.vue_vue_type_style_index_0_lang.f1da905e.js";import{g as Mt,h as Dt,i as Pt,j as It,k as At,l as Ft}from"./index.2062f2c3.js";import{_ as Ut}from"./VFileInput.vue_vue_type_script_setup_true_lang.efda603d.js";import{_ as xt}from"./ContractFormModal.vue_vue_type_script_setup_true_lang.40fe9235.js";import{_ as Lt}from"./ListWidgetSingle.vue_vue_type_style_index_0_lang.64b82896.js";import{_ as Bt}from"./VTag.vue_vue_type_script_setup_true_lang.05f401b8.js";import{u as Tt}from"./viewWrapper.4dd36d96.js";import"./VIcon.vue_vue_type_script_setup_true_lang.1d813936.js";import"./index.adba04a0.js";const Yt={class:"table is-bordered is-fullwidth"},jt={class:"has-text-weight-bold"},Rt={class:"has-text-right is-size-5 has-text-weight-bold"},zt={class:"has-text-weight-bold"},Ot={class:"has-text-right is-size-5 has-text-weight-bold"},Ht={colspan:"2",class:"is-size-5 has-text-weight-bold"},Wt={key:0},Et={key:1},qt=j({props:{contract:null,modelValue:null},emits:["update:modelValue","confirmAction"],setup(c,{emit:o}){const y=it(),i=lt(()=>y.confirmModalOkButtonColor);async function F(){y.$patch({confirmState:!0}),v(),o("confirmAction")}function v(){o("update:modelValue",!1)}return(u,p)=>{const P=Vt,M=L,S=nt;return l(),A(S,{open:c.modelValue,actions:"center",title:u.$t("Confirm_action"),noclose:!0,onClose:v,"cancel-label":u.$t("No")},{content:s(()=>[a(P,{title:u.$t("Are_you_sure")+"?"},null,8,["title"]),t("table",Yt,[t("tbody",null,[t("tr",null,[t("td",null,[t("span",jt,e(u.$t("Contract_sum")),1)]),t("td",Rt,[t("span",null,e(c.contract.payment_amount.toLocaleString()),1)])]),t("tr",null,[t("td",null,[t("span",zt,e(u.$t("Payment_total_sum")),1)]),t("td",Ot,[t("span",null,e(c.contract.payment_total_sum.toLocaleString()),1)])]),t("tr",null,[t("td",Ht,[c.contract.payment_amount>c.contract.payment_total_sum?(l(),d("span",Wt,e(u.$t("Contract_sum_more"))+": "+e((c.contract.payment_amount-c.contract.payment_total_sum).toLocaleString()),1)):c.contract.payment_amount<c.contract.payment_total_sum?(l(),d("span",Et,e(u.$t("Contract_sum_less"))+": "+e((c.contract.payment_total_sum-c.contract.payment_amount).toLocaleString()),1)):g("",!0)])])])])]),action:s(()=>[a(M,{type:"button",class:"is-justify-content-center",color:f(i),outlined:"",onClick:F},{default:s(()=>[I(e(u.$t("Yes")),1)]),_:1},8,["color"])]),_:1},8,["open","title","cancel-label"])}}}),K=pt();async function Gt(c,o){try{const{data:y}=await K({url:`/api/admin/payment/${c}/verify`,method:"PUT",data:{applications:o}});return y.data}catch(y){throw y}}async function Qt(c){try{const{data:o}=await K({url:`/api/admin/payment/${c}/cancel`,method:"PUT"});return o.data}catch(o){throw o}}async function Jt(c){try{const{data:o}=await K({url:`/api/admin/appcontract/${c}/verify`,method:"PUT"});return o.data}catch(o){throw o}}async function Kt(c){try{const{data:o}=await K({url:`/api/admin/appcontract/${c}/application/not-verified`,method:"GET"});return o.data}catch(o){throw o}}const Xt=["onSubmit"],Zt={class:"columns is-multiline"},te={class:"column is-12"},ee={class:"help has-text-danger"},ae=j({props:{modelValue:Boolean,paymentId:{type:Number,default:null}},emits:["update:modelValue","update:list"],async setup(c,{emit:o}){let y,i;const F=c,{t:v,locale:u}=q(),P=J().params?.id??null;let M=m(v("Verify_payment"));const S=m(),h=m([]),r=ht({applications:""});[y,i]=st(()=>w()),await y,i();async function w(){try{const $=await Kt(Number(P));S.value=$}catch($){console.log($)}}async function _($){try{await Gt(F.paymentId,h.value),o("update:list"),k()}catch(N){Object.assign(r,N.response?.data?.errors)}}function k(){h.value=[],o("update:modelValue",!1)}return($,N)=>{const U=Q("Multiselect"),R=yt,z=vt,O=L,b=nt;return l(),A(b,{open:c.modelValue,size:"large",title:f(M),actions:"right",onClose:k},{content:s(()=>[t("form",{id:"payment-verify-form",class:"modal-form",onSubmit:rt(_,["prevent"]),style:{"min-height":"200px"}},[t("div",Zt,[t("div",te,[a(z,null,{default:s(({id:D})=>[a(R,null,{default:s(()=>[a(U,{modelValue:h.value,"onUpdate:modelValue":N[0]||(N[0]=n=>h.value=n),attrs:{id:D},searchable:!1,options:S.value,placeholder:$.$t("Select_statements"),valueProp:"id",label:"code",mode:"tags","close-on-select":!1,"append-new-option":!1},null,8,["modelValue","attrs","options","placeholder"])]),_:2},1024)]),_:1}),t("p",ee,e(f(r).applications[0]),1)])])],40,Xt)]),action:s(({close:D})=>[a(O,{color:"primary",outlined:"",type:"submit",form:"payment-verify-form"},{default:s(()=>[I(e($.$t("Save")),1)]),_:1})]),_:1},8,["open","title"])}}}),oe={class:"applicant-list-wrapper"},ne={class:"is-size-3 mb-3"},le=["textContent"],se=["href"],ie={class:"mr-3"},ce=j({async setup(c){let o,y;const{t:i,locale:F}=q(),{userRoleID:v}=ut(),p=J().params?.id??null,P=it(),M=dt(),S=m(),h=m(),r={orderNumber:{format:(b,D,n)=>`${n+1}`,cellClass:"is-flex-grow-0"},file:{label:i("Invoice"),grow:!0},amount:{label:i("Amount")},status:{label:i("Status")},created_at:{label:i("Paid_date")},verified_at:{label:i("Verified_date")},actions:{label:i("Actions"),align:"center"}},w=m(!1),_=m(!1);[o,y]=st(()=>k()),await o,y();async function k(){const b=await Mt(Number(p));S.value=await b}async function $(b){h.value=b,w.value=!0}async function N(){_.value=!0}async function U(b){h.value=b,P.$patch({confirmModalState:!0})}async function R(){await Jt(p),await k()}async function z(){await Qt(h.value),await k()}function O(){M.success(i("Updated_successfully"))}return(b,D)=>{const n=ot,V=L,B=mt,G=Q("VueIconify"),H=Nt,X=St,Z=kt,tt=Ct,et=ae,at=qt,C=ct;return l(),d("div",oe,[a(B,{class:"mb-4","flex-wrap":"wrap"},{default:s(()=>[a(n,null,{default:s(()=>[t("h1",ne,e(b.$t("Payments")),1)]),_:1}),a(n,{class:"ml-auto"},{default:s(()=>[!S.value?.verified_at&&[1,2,7].includes(f(v))?(l(),A(V,{key:0,type:"button",rounded:"",color:"primary",icon:"feather:check",onClick:N},{default:s(()=>[I(e(b.$t("Verify_contract")),1)]),_:1})):g("",!0)]),_:1})]),_:1}),a(tt,{columns:f(r),data:S.value.payments},{default:s(W=>[a(Z,{rounded:""},{"header-column":s(({column:T})=>[T.key==="orderNumber"?(l(),d("span",{key:0,class:"is-flex-grow-0",textContent:e("#")},null,8,le)):g("",!0)]),"body-cell":s(({row:T,column:Y,value:x})=>[Y.key==="file"?(l(),d("a",{key:0,href:T.file,class:"has-text-primary is-pushed-mobile"},[t("span",ie,e(b.$t("Download")),1),a(G,{icon:"feather:link"})],8,se)):g("",!0),Y.key==="amount"?(l(),d(E,{key:1},[I(e(Number(x).toLocaleString()),1)],64)):g("",!0),Y.key==="status"&&x?(l(),A(H,{key:2,status:x},null,8,["status"])):g("",!0),Y.key==="created_at"&&x?(l(),d(E,{key:3},[I(e(b.$h.formatDate(x,"DD.MM.YYYY HH:mm")),1)],64)):g("",!0),Y.key==="verified_at"&&x?(l(),d(E,{key:4},[I(e(b.$h.formatDate(x,"DD.MM.YYYY HH:mm")),1)],64)):g("",!0),Y.key==="actions"?(l(),d(E,{key:5},[T.status?.color==="warning"&&[1,2,7].includes(f(v))?(l(),A(X,{key:0},{default:s(()=>[a(V,{class:"is-primary is-outlined px-3",onClick:_t=>$(T.id)},{default:s(()=>[I(e(b.$t("Verify")),1)]),_:2},1032,["onClick"]),a(V,{class:"is-danger is-outlined px-3",onClick:_t=>U(T.id)},{default:s(()=>[I(e(b.$t("Cancel")),1)]),_:2},1032,["onClick"])]),_:2},1024)):g("",!0)],64)):g("",!0)]),_:1})]),_:1},8,["columns","data"]),a(et,{modelValue:w.value,"onUpdate:modelValue":D[0]||(D[0]=W=>w.value=W),"payment-id":Number(h.value),"onUpdate:list":D[1]||(D[1]=()=>{k(),O()})},null,8,["modelValue","payment-id"]),a(at,{modelValue:_.value,"onUpdate:modelValue":D[2]||(D[2]=W=>_.value=W),contract:S.value,onConfirmAction:R},null,8,["modelValue","contract"]),a(C,{onConfirmAction:z})])}}}),re=["onSubmit"],ue={class:"columns is-multiline"},de={class:"column is-12"},me=j({props:{modelValue:{type:Boolean,default:!1},contractId:{default:""},filePropName:null},emits:["update:modelValue","update:data"],setup(c,{emit:o}){const y=c,{t:i,locale:F}=q(),v=m([]),u=m(""),p=m(!1);let P=m(i("Add_file"));async function M(w){try{if(p.value=!0,v.value.length){const _=new FormData;_.append(y.filePropName,v.value[0]??""),await Dt(Number(y.contractId),_),o("update:data"),S()}else u.value=i("File_upload_field_required")}catch(_){throw _}finally{p.value=!1}}function S(){v.value=[],u.value="",o("update:modelValue",!1)}function h(w){const _=w.target;v.value=_.files?.length&&[_.files[0]],u.value=""}function r(){v.value=[]}return(w,_)=>{const k=Ut,$=L,N=nt;return l(),A(N,{open:c.modelValue,size:"large",title:f(P),actions:"right",onClose:S},{content:s(()=>[t("form",{id:"file-upload-form",class:"modal-form",onSubmit:rt(M,["prevent"])},[t("div",ue,[t("div",de,[a(k,{files:v.value,onFileUpload:h,onFileRemove:r,"error-message":u.value,"remote-files":[]},null,8,["files","error-message"])])])],40,re)]),action:s(({close:U})=>[a($,{color:"primary",outlined:"",type:"submit",form:"file-upload-form",loading:p.value,disabled:p.value},{default:s(()=>[I(e(w.$t("Save")),1)]),_:1},8,["loading","disabled"])]),_:1},8,["open","title"])}}}),_e={class:"container is-fluid"},fe={class:"columns"},pe={class:"column is-6"},he={class:"table is-hoverable is-bordered is-fullwidth mb-5"},ye={class:"has-text-weight-bold"},ve={class:"has-text-weight-bold"},be={class:"has-text-weight-bold"},$e={class:"has-text-weight-bold"},ge={class:"has-text-weight-bold"},we={class:"table is-hoverable is-bordered is-fullwidth"},Ve={class:"has-text-weight-bold"},ke={class:"is-flex is-align-items-center"},Ce=["href"],Se={class:"mr-3"},Ne={key:1,class:"has-text-danger"},Me={class:"has-text-weight-bold"},De={class:"is-flex is-align-items-center"},Pe=["href"],Ie={class:"mr-3"},Ae={key:1,class:"has-text-danger"},Fe={class:"has-text-weight-bold"},Ue={class:"is-flex is-align-items-center"},xe=["href"],Le={class:"mr-3"},Be={key:1,class:"has-text-danger"},Te={class:"column is-6"},Ye={class:"table is-hoverable is-bordered is-fullwidth"},je=j({async setup(c){let o,y;const{t:i,locale:F}=q(),v=it(),{userRoleID:u}=ut(),p=lt(()=>({name:{label:i("Name"),searchable:!0},legal_entity:{label:i("Applicant")},payment_amount:{label:i("Contract_amount")},template_file:{label:i("Template_file")},legal_file:{label:i("Legal_entity_file")},file:{label:i("File")},verified_at:{label:i("Payment_status")},created_at:{label:i("Date")}})),P=dt(),M=m(!1),h=J().params?.id??null,r=m(),w=m(),_=m(""),k=m(!1),$=m();[o,y]=st(()=>N()),await o,y();async function N(){const n=await Pt(Number(h));r.value=await n,w.value=r.value?.applications}function U(n){_.value=n,M.value=!0}function R(){k.value=!0}async function z(n){$.value=n,v.$patch({confirmModalState:!0})}function O(){P.success(i("Updated_successfully"))}async function b(){await It(Number(h),$.value),await N(),D()}function D(){P.success(i("Success"))}return(n,V)=>{const B=Q("VueIconify"),G=Bt,H=Lt,X=Q("RouterLink"),Z=mt,tt=xt,et=me,at=ct;return l(),d("div",_e,[t("div",fe,[t("div",pe,[a(H,{title:n.$t("Contract_details"),straight:"",class:"list-widget-v3"},{actions:s(()=>[!r.value?.verified_at&&[1,2,7].includes(f(u))?(l(),d("a",{key:0,href:"javascript:;",onClick:R},[a(B,{icon:"feather:edit-2"})])):g("",!0)]),default:s(()=>[t("table",he,[t("tbody",null,[t("tr",null,[t("td",ye,e(f(p).name.label),1),t("td",null,e(r.value?.name),1)]),t("tr",null,[t("td",ve,e(f(p).payment_amount.label),1),t("td",null,e(r.value?.payment_amount.toLocaleString()),1)]),t("tr",null,[t("td",be,e(f(p).legal_entity.label),1),t("td",null,e(r.value?.legal_entity?.name),1)]),t("tr",null,[t("td",$e,e(f(p).created_at.label),1),t("td",null,e(n.$h.formatDate(r.value?.created_at,"DD.MM.YYYY")),1)]),t("tr",null,[t("td",ge,e(f(p).verified_at.label),1),t("td",null,[a(G,{class:"is-size-6",color:r.value.verified_at?"primary":"warning",rounded:"",label:r.value.verified_at?n.$t("Paid"):n.$t("Not_Paid")},null,8,["color","label"])])])])])]),_:1},8,["title"]),a(H,{title:n.$t("Contract_files_list"),straight:"",class:"list-widget-v3"},{default:s(()=>[t("table",we,[t("tbody",null,[t("tr",null,[t("td",Ve,e(f(p).template_file.label),1),t("td",ke,[r.value?.template_file?(l(),d("a",{key:0,href:r.value?.template_file,class:"has-text-primary",download:""},[t("span",Se,e(n.$t("Download")),1),a(B,{icon:"feather:link"})],8,Ce)):(l(),d("span",Ne,e(n.$t("No_template_file")),1)),[1,2,7].includes(f(u))?(l(),A(L,{key:2,class:"ml-auto",color:"primary",rounded:"",icon:"fas fa-plus",onClick:V[0]||(V[0]=C=>U("template_file"))},{default:s(()=>[I(e(n.$t("Upload")),1)]),_:1})):g("",!0)])]),t("tr",null,[t("td",Me,e(f(p).legal_file.label),1),t("td",De,[r.value?.legal_file?(l(),d("a",{key:0,href:r.value?.legal_file,class:"has-text-primary",download:""},[t("span",Ie,e(n.$t("Download")),1),a(B,{icon:"feather:link"})],8,Pe)):(l(),d("span",Ae,e(n.$t("No_legal_file")),1))])]),t("tr",null,[t("td",Fe,e(f(p).file.label),1),t("td",Ue,[r.value?.file?(l(),d("a",{key:0,href:r.value?.file,class:"has-text-primary",download:""},[t("span",Le,e(n.$t("Download")),1),a(B,{icon:"feather:link"})],8,xe)):(l(),d("span",Be,e(n.$t("No_completed_file")),1)),[1,2,7].includes(f(u))?(l(),A(L,{key:2,class:"ml-auto",color:"primary",rounded:"",icon:"fas fa-plus",onClick:V[1]||(V[1]=C=>U("file"))},{default:s(()=>[I(e(n.$t("Upload")),1)]),_:1})):g("",!0)])])])])]),_:1},8,["title"])]),t("div",Te,[a(H,{title:n.$t("Statements_List"),straight:"",class:"list-widget-v3"},{default:s(()=>[t("table",Ye,[t("thead",null,[t("tr",null,[t("th",null,e(n.$t("Statement_code")),1),t("th",null,e(n.$t("Drug_name")),1),t("th",null,e(n.$t("Status")),1)])]),t("tbody",null,[(l(!0),d(E,null,bt(w.value,C=>(l(),d("tr",null,[t("td",null,[a(X,{class:"has-text-primary",to:`/app/statements/${C.id}`},{default:s(()=>[I(e(C.uuid),1)]),_:2},1032,["to"])]),t("td",null,e(C.drug),1),t("td",null,[a(Z,{"justify-content":"space-between"},{default:s(()=>[a(ot,null,{default:s(()=>[a(G,{class:"is-size-6",color:C.is_paid?"primary":"warning",rounded:"",label:C.is_paid?n.$t("Paid"):n.$t("Not_Paid")},null,8,["color","label"])]),_:2},1024),C.is_paid&&!r.value?.verified_at?(l(),A(ot,{key:0},{default:s(()=>[[1,2,7].includes(f(u))?(l(),A(L,{key:0,color:"warning",rounded:"",textContent:e(n.$t("Reject_statement_status")),onClick:W=>z(C.id)},null,8,["textContent","onClick"])):g("",!0)]),_:2},1024)):g("",!0)]),_:2},1024)])]))),256))])])]),_:1},8,["title"])])]),a(tt,{modelValue:k.value,"onUpdate:modelValue":V[2]||(V[2]=C=>k.value=C),"item-id":Number(f(h)),"onUpdate:list":V[3]||(V[3]=()=>{N(),O(),h.value=""})},null,8,["modelValue","item-id"]),a(et,{modelValue:M.value,"onUpdate:modelValue":V[4]||(V[4]=C=>M.value=C),"contract-id":f(h),onClose:N,"file-prop-name":_.value,"onUpdate:data":V[5]||(V[5]=()=>{N(),D()})},null,8,["modelValue","contract-id","file-prop-name"]),a(at,{onConfirmAction:b})])}}});const Re=$t(je,[["__scopeId","data-v-98e13470"]]),ze={class:"statement-detail-wrapper"},Oe={key:0,class:"columns mt-5"},He={key:1,class:"mt-5"},ua=j({setup(c){const{t:o,locale:y}=q(),i=J(),F=i.params?.id??null,v=m(i.hash.slice(1)||"details"),u=m([{label:o("Contract_details"),value:"details",icon:"lnil lnil-tap"},{label:o("Payment"),value:"payment",icon:"fas fa-tree"}]),p=m(),P=m(),M=m();return Tt().setPageTitle(o("Contract_card")),gt({title:lt(()=>o("Contract_card"))}),wt(async()=>{const h=await At(Number(F)),r=await Ft(Number(F));p.value=h,P.value=r,M.value=r.map((w,_)=>_)}),(h,r)=>{const w=Re,_=ce,k=ft;return l(),d("div",ze,[a(k,{selected:v.value,tabs:u.value},{tab:s(({activeValue:$})=>[$==="details"?(l(),d("div",Oe,[a(w)])):g("",!0),$==="payment"?(l(),d("div",He,[a(_)])):g("",!0)]),_:1},8,["selected","tabs"])])}}});export{ua as default};
