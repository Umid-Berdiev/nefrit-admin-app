import{a as x}from"./VPlaceholderSection.2f3a5682.js";import{A as k,W as q,B as r,r as B,C as D,E as $,q as E,o as L,g as P,w as i,k as o,s as n,G as l,t as _,x as z,p as G,a4 as Q,a3 as R,a2 as T,Q as W}from"./index.433ccf37.js";import{_ as H}from"./VFileInput.4f9e647b.js";import{h as J,u as K,i as X}from"./index.bd8beb4a.js";import{g as Y,h as Z}from"./index.44bf4aef.js";const ee=["onSubmit"],te={class:"columns is-multiline"},ae={class:"column is-12"},le={class:"help has-text-danger"},ne={class:"column is-12"},oe={class:"help has-text-danger"},se={class:"column is-12"},ie={class:"help has-text-danger"},me={class:"column is-12"},de={class:"help has-text-danger"},ce={class:"column is-12"},ge=k({props:{modelValue:Boolean,itemId:{type:Number,default:null}},emits:["update:modelValue","update:list"],setup(g,{emit:b}){const u=g,{t:y,locale:j}=q();let v=r(y("Add"));const c=r([]),V=r(),I=r(),a=B({legal_entity_id:null,name:"",payment_amount:0,template_file:"",applications:[]}),f=r([]),d=B({name:"",payment_amount:"",template_file:"",legal_entity_id:"",applications:""});D(async()=>{const t=await Y(j.value);V.value=t}),$(()=>u.itemId,async(t,e)=>{if(t){v.value=y("Edit");const s=await J(Number(u.itemId));Object.assign(a,s),f.value=s.applications.map(p=>p.id)}},{deep:!0,immediate:!0}),$(()=>a.legal_entity_id,async(t,e)=>{if(a.applications=[],t){const s=await Z(Number(t));I.value=s}},{deep:!0,immediate:!0});async function N(t){try{const e=new FormData;e.append("name",a.name),e.append("payment_amount",a.payment_amount),e.append("template_file",c.value.length?c.value[0]:""),e.append("legal_entity_id",a.legal_entity_id),f.value.forEach(s=>{e.append("applications[]",s)}),u.itemId?await K(u.itemId,e):await X(e),b("update:list"),C()}catch(e){Object.assign(d,e.response?.data?.errors)}}function C(){u.itemId||(v.value=y("Add"),c.value=[],Object.assign(a,{legal_entity_id:null,name:"",payment_amount:0,template_file:"",applications:[]}),Object.assign(d,{name:"",payment_amount:"",template_file:"",applications:"",legal_entity_id:""})),b("update:modelValue",!1)}function O(t){const e=t.target;console.log("files: ",e.files),c.value=e.files&&[e.files[0]]}function A(t){c.value=[]}return(t,e)=>{const s=Q,p=R,S=E("Multiselect"),w=T,F=H,M=W,U=x;return L(),P(U,{open:g.modelValue,size:"large",title:l(v),actions:"right",onClose:C},{content:i(()=>[o("form",{id:"contract-form",class:"modal-form",onSubmit:z(N,["prevent"])},[o("div",te,[o("div",ae,[n(p,{label:t.$t("Contract_name"),required:""},{default:i(()=>[n(s,{modelValue:l(a).name,"onUpdate:modelValue":e[0]||(e[0]=m=>l(a).name=m)},null,8,["modelValue"]),o("p",le,_(l(d).name[0]),1)]),_:1},8,["label"])]),o("div",ne,[n(p,{label:t.$t("Contract_amount"),required:""},{default:i(()=>[n(s,{type:"number",modelValue:l(a).payment_amount,"onUpdate:modelValue":e[1]||(e[1]=m=>l(a).payment_amount=m)},null,8,["modelValue"]),o("p",oe,_(l(d).payment_amount[0]),1)]),_:1},8,["label"])]),o("div",se,[n(p,null,{default:i(({id:m})=>[n(w,null,{default:i(()=>[n(S,{modelValue:l(a).legal_entity_id,"onUpdate:modelValue":e[2]||(e[2]=h=>l(a).legal_entity_id=h),attrs:{id:m},searchable:!0,options:V.value,placeholder:t.$t("Select_applicant"),valueProp:"id",label:"name",disabled:Boolean(g.itemId)},null,8,["modelValue","attrs","options","placeholder","disabled"])]),_:2},1024)]),_:1}),o("p",ie,_(l(d).legal_entity_id[0]),1)]),o("div",me,[n(p,null,{default:i(({id:m})=>[n(w,null,{default:i(()=>[n(S,{modelValue:f.value,"onUpdate:modelValue":e[3]||(e[3]=h=>f.value=h),attrs:{id:m},searchable:!1,options:I.value,placeholder:t.$t("Select_statements"),valueProp:"id",label:"code",mode:"tags","close-on-select":!1,disabled:!l(a).legal_entity_id},null,8,["modelValue","attrs","options","placeholder","disabled"])]),_:2},1024)]),_:1}),o("p",de,_(l(d).applications[0]),1)]),o("div",ce,[n(F,{onFileUpload:O,onFileRemove:A,"error-message":l(d).template_file[0],files:c.value,"remote-files":[]},null,8,["error-message","files"])])])],40,ee)]),action:i(({close:m})=>[n(M,{color:"primary",outlined:"",type:"submit",form:"contract-form"},{default:i(()=>[G(_(t.$t("Save")),1)]),_:1})]),_:1},8,["open","title"])}}});export{ge as _};
