import{_ as z}from"./VModal.vue_vue_type_style_index_0_lang.0359f83d.js";import{z as R,V as j,e as Y,o as N,f as A,w as o,q as a,m as E,t as h,E as p,j as u,k as Z,G as ee,i as te,s as ae,F as le,bS as se,$ as k,a0 as O,A as _,bv as L,r as M,D as T,v as G,a1 as oe,P}from"./index.81fd6e18.js";import{_ as H}from"./VTextarea.7c28aa3d.js";import{p as ne,q as ue,s as ie,t as de,v as ce,w as me,x as re,y as _e}from"./index.fb3bf6f6.js";import{_ as pe}from"./VFileInput.vue_vue_type_script_setup_true_lang.caab8d85.js";import{_ as fe,a as ve}from"./VOption.vue_vue_type_style_index_0_lang.c62bcddd.js";const J=R({props:{modelValue:{default:""},isRequired:{type:Boolean,default:!1},list:null},emits:["update:modelValue"],setup(b,{emit:$}){const f=b,{t:x}=j(),i=Y({get:()=>f.modelValue,set:async V=>{$("update:modelValue",V)}});return(V,g)=>{const v=se,d=fe,m=ve,n=k,S=O;return N(),A(S,null,{default:o(()=>[a(v,null,{default:o(()=>[E(h(p(x)("Status"))+" ",1),u("span",{class:Z({"has-text-danger":b.isRequired})},"*",2)]),_:1}),a(n,null,{default:o(()=>[a(m,{modelValue:p(i),"onUpdate:modelValue":g[0]||(g[0]=l=>ee(i)?i.value=l:null)},{default:o(()=>[a(d,{disabled:"",hidden:"",value:""},{default:o(()=>[E(h(p(x)("Select"))+" ...",1)]),_:1}),(N(!0),te(le,null,ae(b.list,l=>(N(),A(d,{key:l.id,value:l.id,textContent:h(l.name)},null,8,["value","textContent"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})}}}),Ve=["onSubmit"],ge={class:"columns is-multiline"},he={class:"column is-12"},be={class:"help has-text-danger"},Se={class:"column is-12"},xe={class:"help has-text-danger"},ye={class:"column is-12"},Ie={class:"help has-text-danger"},ke=R({props:{modelValue:Boolean,itemId:{type:Number,default:null},parentId:{type:Number,default:null}},emits:["update:modelValue","update:list"],async setup(b,{emit:$}){let f,x;const i=b,{t:V}=j();let g=_(V("Add"));const v=_(!1),d=_(""),m=_(""),n=_(),S=([f,x]=L(()=>ue()),f=await f,x(),f),l=M({message:"",text:"",status_id:""});T(()=>i.itemId,async r=>{if(!r)g.value=V("Add"),d.value="",m.value="",n.value="";else{g.value=V("Edit");const t=await ne(Number(i.itemId));d.value=t.message,m.value=t.text,n.value=t.status?.id}},{deep:!0,immediate:!0});async function U(r){try{v.value=!0;const t={message:d.value,text:m.value,application_id:i.parentId,status_id:n.value};i.itemId?await ie(i.itemId,t):await de(t),$("update:list"),y()}catch(t){console.log({error:t}),Object.assign(l,t.response?.data?.errors)}finally{v.value=!1}}function y(){d.value="",m.value="",n.value="",Object.assign(l,{message:"",text:"",status_id:""}),$("update:modelValue",!1)}function w(r){l[r.target.name]=""}return(r,t)=>{const D=oe,B=k,F=O,s=H,e=J,c=P,C=z;return N(),A(C,{open:b.modelValue,size:"large",title:p(g),actions:"right",onClose:y},{content:o(()=>[u("form",{id:"notice-form",class:"modal-form",onSubmit:G(U,["prevent"])},[u("div",ge,[u("div",he,[a(F,{label:r.$t("Notice_message"),required:""},{default:o(()=>[a(B,null,{default:o(()=>[a(D,{name:"message",modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=I=>d.value=I),onInput:w},null,8,["modelValue"]),u("p",be,h(p(l).message[0]),1)]),_:1})]),_:1},8,["label"])]),u("div",Se,[a(F,{label:r.$t("Notice_details"),required:""},{default:o(()=>[a(B,null,{default:o(()=>[a(s,{name:"text",placeholder:r.$t("Add_text"),modelValue:m.value,"onUpdate:modelValue":t[1]||(t[1]=I=>m.value=I),onInput:w},null,8,["placeholder","modelValue"]),u("p",xe,h(p(l).text[0]),1)]),_:1})]),_:1},8,["label"])]),u("div",ye,[a(e,{name:"status_id",modelValue:n.value,"onUpdate:modelValue":t[2]||(t[2]=I=>n.value=I),list:p(S),"is-required":!0,onChange:w},null,8,["modelValue","list"]),u("p",Ie,h(p(l).status_id[0]),1)])])],40,Ve)]),action:o(({close:I})=>[a(c,{loading:v.value,color:"primary",outlined:"",type:"submit",form:"notice-form",disabled:v.value},{default:o(()=>[E(h(r.$t("Save")),1)]),_:1},8,["loading","disabled"])]),_:1},8,["open","title"])}}}),$e=["onSubmit"],Ce={class:"columns is-multiline"},we={class:"column is-12"},Ne={class:"help has-text-danger"},Be={class:"column is-12"},Fe={class:"help has-text-danger"},qe={class:"column is-12"},Oe=R({props:{modelValue:Boolean,itemId:{type:Number,default:null},parentId:{type:Number,default:null}},emits:["update:modelValue","update:list"],async setup(b,{emit:$}){let f,x;const i=b,{t:V}=j();let g=_(V("Add"));const v=_(!1),d=_(""),m=_(),n=_([]),S=_([]),l=_([]),U=([f,x]=L(()=>me()),f=await f,x(),f),y=M({text:"",status_id:""});T(()=>i.itemId,async(s,e)=>{if(s){g.value=V("Edit");const c=await ce(Number(i.itemId));d.value=c.text,m.value=c.status?.id,S.value=c.files}},{deep:!0,immediate:!0});async function w(s){try{v.value=!0;const e={text:d.value,application_id:i.parentId,status_id:m.value,files:n.value,removed_files:l.value},c=new FormData;c.append("text",e.text),c.append("application_id",e.application_id),c.append("status_id",e.status_id),n.value.forEach(C=>{c.append("files[]",C)}),l.value.forEach(C=>{c.append("removes[]",C)}),i.itemId?await re(i.itemId,c):await _e(c),$("update:list"),r()}catch(e){console.log({error:e}),Object.assign(y,e.response?.data?.errors)}finally{v.value=!1}}function r(){g.value=V("Add"),d.value="",m.value="",n.value=[],S.value=[],l.value=[],Object.assign(y,{text:"",status_id:""}),$("update:modelValue",!1)}function t(s){y[s.target.name]=""}function D(s){const e=s.target;console.log("files: ",e.files),e.files&&n.value?.push(e.files[0])}function B(s){n.value=n.value?.filter(e=>e.lastModified!==s)}function F(s){l.value.push(s),S.value=S.value?.filter(e=>e.id!==s)}return(s,e)=>{const c=H,C=k,I=O,K=J,Q=pe,W=P,X=z;return N(),A(X,{open:b.modelValue,size:"large",title:p(g),actions:"right",onClose:r},{content:o(()=>[u("form",{id:"conclusion-form",class:"modal-form",onSubmit:G(w,["prevent"])},[u("div",Ce,[u("div",we,[a(I,{label:s.$t("conclusion_in_details"),required:""},{default:o(()=>[a(C,null,{default:o(()=>[a(c,{name:"text",placeholder:s.$t("Add_text"),modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=q=>d.value=q),onInput:t},null,8,["placeholder","modelValue"]),u("p",Ne,h(p(y).text[0]),1)]),_:1})]),_:1},8,["label"])]),u("div",Be,[a(K,{name:"status_id",modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=q=>m.value=q),list:p(U),"is-required":!0,onChange:t},null,8,["modelValue","list"]),u("p",Fe,h(p(y).status_id[0]),1)]),u("div",qe,[a(Q,{files:n.value,"remote-files":S.value,onFileUpload:D,onFileRemove:B,onRemoteFileRemove:F,"error-message":""},null,8,["files","remote-files"])])])],40,$e)]),action:o(({close:q})=>[a(W,{loading:v.value,color:"primary",outlined:"",type:"submit",form:"conclusion-form",disabled:v.value},{default:o(()=>[E(h(s.$t("Save")),1)]),_:1},8,["loading","disabled"])]),_:1},8,["open","title"])}}});export{Oe as _,ke as a,J as b};
