import{_ as U}from"./VModal.vue_vue_type_style_index_0_lang.61b38c15.js";import{A as q,O as D,B as c,bv as M,r as O,E as j,o as k,g as L,w as r,k as o,s as n,t as S,G as v,x as R,p as T,a5 as Y,a3 as z,a4 as G,Q as H}from"./index.bb4908f5.js";import{_ as J}from"./StatusSelect.vue_vue_type_script_setup_true_lang.4441b2a0.js";import{_ as K}from"./VTextarea.a25adf21.js";import{F as Z,G as ee,H as te,I as ae,J as se,K as oe,L as le,M as ne}from"./index.1a4077bb.js";import{_ as ie}from"./VFileInput.vue_vue_type_script_setup_true_lang.c63c47c0.js";const ue=["onSubmit"],de={class:"columns is-multiline"},ce={class:"column is-12"},re={class:"help has-text-danger"},me={class:"column is-12"},pe={class:"help has-text-danger"},_e={class:"column is-12"},fe={class:"help has-text-danger"},Be=q({props:{modelValue:Boolean,itemId:{type:Number,default:null},parentId:{type:Number,default:null}},emits:["update:modelValue","update:list"],async setup(y,{emit:$}){let _,N;const m=y,{t:V}=D();let b=c(V("Add"));const f=c(!1),i=c(""),u=c(""),l=c(),I=([_,N]=M(()=>ee()),_=await _,N(),_),p=O({message:"",text:"",status_id:""});j(()=>m.itemId,async d=>{if(!d)b.value=V("Add"),i.value="",u.value="",l.value="";else{b.value=V("Edit");const t=await Z(Number(m.itemId));i.value=t.message,u.value=t.text,l.value=t.status?.id}},{deep:!0,immediate:!0});async function A(d){try{f.value=!0;const t={message:i.value,text:u.value,application_id:m.parentId,status_id:l.value};m.itemId?await te(m.itemId,t):await ae(t),$("update:list"),g()}catch(t){Object.assign(p,t.response?.data?.errors)}finally{f.value=!1}}function g(){i.value="",u.value="",l.value="",Object.assign(p,{message:"",text:"",status_id:""}),$("update:modelValue",!1)}function w(d){p[d.target.name]=""}return(d,t)=>{const E=Y,C=z,B=G,a=K,e=J,s=H,x=U;return k(),L(x,{open:y.modelValue,size:"large",title:v(b),actions:"right",onClose:g},{content:r(()=>[o("form",{id:"notice-form",class:"modal-form",onSubmit:R(A,["prevent"])},[o("div",de,[o("div",ce,[n(B,{label:d.$t("Notice_message"),required:""},{default:r(()=>[n(C,null,{default:r(()=>[n(E,{name:"message",modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=h=>i.value=h),onInput:w},null,8,["modelValue"]),o("p",re,S(v(p).message[0]),1)]),_:1})]),_:1},8,["label"])]),o("div",me,[n(B,{label:d.$t("Notice_details"),required:""},{default:r(()=>[n(C,null,{default:r(()=>[n(a,{name:"text",placeholder:d.$t("Add_text"),modelValue:u.value,"onUpdate:modelValue":t[1]||(t[1]=h=>u.value=h),onInput:w},null,8,["placeholder","modelValue"]),o("p",pe,S(v(p).text[0]),1)]),_:1})]),_:1},8,["label"])]),o("div",_e,[n(e,{name:"status_id",modelValue:l.value,"onUpdate:modelValue":t[2]||(t[2]=h=>l.value=h),list:v(I),"is-required":!0,onChange:w},null,8,["modelValue","list"]),o("p",fe,S(v(p).status_id[0]),1)])])],40,ue)]),action:r(({close:h})=>[n(s,{loading:f.value,color:"primary",outlined:"",type:"submit",form:"notice-form",disabled:f.value},{default:r(()=>[T(S(d.$t("Save")),1)]),_:1},8,["loading","disabled"])]),_:1},8,["open","title"])}}}),ve=["onSubmit"],ge={class:"columns is-multiline"},he={class:"column is-12"},Ve={class:"help has-text-danger"},be={class:"column is-12"},Ie={class:"help has-text-danger"},xe={class:"column is-12"},Fe=q({props:{modelValue:Boolean,itemId:{type:Number,default:null},parentId:{type:Number,default:null}},emits:["update:modelValue","update:list"],async setup(y,{emit:$}){let _,N;const m=y,{t:V}=D();let b=c(V("Add"));const f=c(!1),i=c(""),u=c(),l=c([]),I=c([]),p=c([]),A=([_,N]=M(()=>oe()),_=await _,N(),_),g=O({text:"",status_id:""});j(()=>m.itemId,async(a,e)=>{if(a){b.value=V("Edit");const s=await se(Number(m.itemId));i.value=s.text,u.value=s.status?.id,I.value=s.files}},{deep:!0,immediate:!0});async function w(a){try{f.value=!0;const e={text:i.value,application_id:m.parentId,status_id:u.value,files:l.value,removed_files:p.value},s=new FormData;s.append("text",e.text),s.append("application_id",e.application_id),s.append("status_id",e.status_id),l.value.forEach(x=>{s.append("files[]",x)}),p.value.forEach(x=>{s.append("removes[]",x)}),m.itemId?await le(m.itemId,s):await ne(s),$("update:list"),d()}catch(e){Object.assign(g,e.response?.data?.errors)}finally{f.value=!1}}function d(){b.value=V("Add"),i.value="",u.value="",l.value=[],I.value=[],p.value=[],Object.assign(g,{text:"",status_id:""}),$("update:modelValue",!1)}function t(a){g[a.target.name]=""}function E(a){const e=a.target;e.files&&l.value?.push(e.files[0])}function C(a){l.value=l.value?.filter(e=>e.lastModified!==a)}function B(a){p.value.push(a),I.value=I.value?.filter(e=>e.id!==a)}return(a,e)=>{const s=K,x=z,h=G,Q=J,P=ie,W=H,X=U;return k(),L(X,{open:y.modelValue,size:"large",title:v(b),actions:"right",onClose:d},{content:r(()=>[o("form",{id:"conclusion-form",class:"modal-form",onSubmit:R(w,["prevent"])},[o("div",ge,[o("div",he,[n(h,{label:a.$t("conclusion_in_details"),required:""},{default:r(()=>[n(x,null,{default:r(()=>[n(s,{name:"text",placeholder:a.$t("Add_text"),modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=F=>i.value=F),onInput:t},null,8,["placeholder","modelValue"]),o("p",Ve,S(v(g).text[0]),1)]),_:1})]),_:1},8,["label"])]),o("div",be,[n(Q,{name:"status_id",modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=F=>u.value=F),list:v(A),"is-required":!0,onChange:t},null,8,["modelValue","list"]),o("p",Ie,S(v(g).status_id[0]),1)]),o("div",xe,[n(P,{files:l.value,"remote-files":I.value,onFileUpload:E,onFileRemove:C,onRemoteFileRemove:B,"error-message":""},null,8,["files","remote-files"])])])],40,ve)]),action:r(({close:F})=>[n(W,{loading:f.value,color:"primary",outlined:"",type:"submit",form:"conclusion-form",disabled:f.value},{default:r(()=>[T(S(a.$t("Save")),1)]),_:1},8,["loading","disabled"])]),_:1},8,["open","title"])}}});export{Be as _,Fe as a};
