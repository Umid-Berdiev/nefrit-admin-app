import{_ as re}from"./ConfirmActionModal.dc1a3c08.js";import{_ as ue,u as ce}from"./VModal.7c3df6a9.js";import{K as O,r as C,m as R,w as de,o as me,E as pe,p as g,q as M,s as l,y as r,f as a,M as n,D as w,H as E,C as _e,V as fe,bI as ve,c as W,bp as ge,x as U,B as I,i as he}from"./index.f060b7c6.js";import{a as H,_ as K}from"./VControl.068ba628.js";import{u as G}from"./vue-i18n.runtime.esm-bundler.1634ed66.js";import{f as be,a as Ve,u as $e,c as ye,b as Ce,r as we}from"./index.12530604.js";import{_ as L}from"./VField.17e54227.js";import{_ as ke,a as Ne}from"./VFlexTable.4ba052d2.js";import{_ as Se}from"./VFlexPagination.b3a191bb.js";import{_ as Ie}from"./VDropdown.a61ebde9.js";import{_ as Le}from"./VPlaceholderSection.afc34ed0.js";import{_ as Me}from"./VCheckbox.a095a4ed.js";import{_ as ze,a as Ae}from"./TableActionsBlock.3e62a7b3.js";import{u as Be}from"./viewWrapper.7134460b.js";import{u as xe}from"./useNotyf.14aeb83f.js";import"./VIcon.a5a02b18.js";import"./useDropdown.191976f8.js";import"./VButtons.eeafcbc5.js";const De=["onSubmit"],Fe={class:"columns is-multiline"},Te={class:"column is-12"},Ue={class:"help has-text-danger"},Re={class:"column is-12"},Ee={class:"help has-text-danger"},Oe=O({props:{modelValue:Boolean,departmentId:{type:Number,default:null}},emits:["update:modelValue","update:list"],setup(z,{emit:f}){const m=z,{t:c}=G(),b=C(c("Add")),_=C(!1),k=C([]),N=R({"name.uz":[],"name.en":[],"name.ru":[],stages:[]}),e=R({name:{uz:"",ru:"",en:""},stages:[]});de(()=>m.departmentId,async s=>{if(s){b.value=c("Edit");const i=await be(Number(m.departmentId));Object.assign(e,i),Object.assign(e.stages,i.stages.map(({id:h})=>h))}},{deep:!0,immediate:!0}),me(async()=>{const s=await Ve();k.value=s});async function S(s){try{_.value=!0,m.departmentId?await $e(m.departmentId,e):await ye(e),f("update:list"),u()}catch(i){Object.assign(N,i.response?.data?.errors)}finally{_.value=!1}}function u(){b.value=c("Add"),A(),v(),f("update:modelValue",!1)}function A(){Object.assign(e,{name:{uz:"",ru:"",en:""},stages:[]})}function v(){Object.assign(N,{"name.uz":[],"name.en":[],"name.ru":[],stages:[]})}return(s,i)=>{const h=H,V=K,D=pe("Multiselect"),F=fe,B=ue;return g(),M(B,{open:z.modelValue,size:"large",title:b.value,actions:"right",onClose:i[4]||(i[4]=d=>u())},{content:l(()=>[r("form",{id:"department-form",class:"modal-form",onSubmit:E(S,["prevent"])},[r("div",Fe,[r("div",Te,[a(L,{label:s.$t("Name_uz"),required:""},{default:l(()=>[a(V,null,{default:l(()=>[a(h,{name:"name_uz",placeholder:s.$t("Type_name_uz"),modelValue:n(e).name.uz,"onUpdate:modelValue":i[0]||(i[0]=d=>n(e).name.uz=d)},null,8,["placeholder","modelValue"]),r("p",Ue,w(n(N)["name.uz"][0]),1)]),_:1})]),_:1},8,["label"]),a(L,{label:s.$t("Name_ru")},{default:l(()=>[a(V,null,{default:l(()=>[a(h,{name:"name_ru",placeholder:s.$t("Type_name_ru"),modelValue:n(e).name.ru,"onUpdate:modelValue":i[1]||(i[1]=d=>n(e).name.ru=d)},null,8,["placeholder","modelValue"])]),_:1})]),_:1},8,["label"]),a(L,{label:s.$t("Name_en")},{default:l(()=>[a(V,null,{default:l(()=>[a(h,{name:"name_en",placeholder:s.$t("Type_name_en"),modelValue:n(e).name.en,"onUpdate:modelValue":i[2]||(i[2]=d=>n(e).name.en=d)},null,8,["placeholder","modelValue"])]),_:1})]),_:1},8,["label"])]),r("div",Re,[a(L,{label:s.$t("Stages"),required:""},{default:l(()=>[a(V,null,{default:l(()=>[a(D,{modelValue:n(e).stages,"onUpdate:modelValue":i[3]||(i[3]=d=>n(e).stages=d),searchable:!1,options:k.value,placeholder:s.$t("Select_stages"),valueProp:"id",label:"name",mode:"tags","close-on-select":!1},null,8,["modelValue","options","placeholder"]),r("p",Ee,w(n(N).stages[0]),1)]),_:1})]),_:1},8,["label"])])])],40,De)]),action:l(({close:d})=>[a(F,{loading:_.value,color:"primary",outlined:"",type:"submit",form:"department-form",disabled:_.value},{default:l(()=>[_e(w(s.$t("Save")),1)]),_:1},8,["loading","disabled"])]),_:1},8,["open","title"])}}}),je=["onClick"],Pe=r("div",{class:"icon"},[r("i",{class:"iconify","aria-hidden":"true","data-icon":"feather:edit"})],-1),qe={class:"meta"},We=r("hr",{class:"dropdown-divider"},null,-1),He=["onClick"],Ke=r("div",{class:"icon"},[r("i",{class:"iconify","aria-hidden":"true","data-icon":"feather:trash"})],-1),Ge={class:"meta"},Je=O({emits:["edit","remove"],setup(z,{emit:f}){return(m,c)=>{const b=Ie;return g(),M(b,{icon:"feather:more-vertical",class:"is-pushed-mobile",spaced:"",right:""},{content:l(({close:_})=>[r("a",{role:"menuitem",href:"#",class:"dropdown-item is-media",onClick:E(()=>{f("edit"),_()},["prevent"])},[Pe,r("div",qe,[r("span",null,w(m.$t("Edit")),1)])],8,je),We,r("a",{role:"menuitem",href:"#",class:"dropdown-item is-media",onClick:E(()=>{f("remove"),_()},["prevent"])},[Ke,r("div",Ge,[r("span",null,w(m.$t("Remove")),1)])],8,He)]),_:1})}}}),Qe={class:"applicant-list-wrapper"},Xe=["textContent"],Ye={key:0,class:"flex-list-inner"},bt=O({async setup(z){let f,m;const{t:c,locale:b}=G();ve({title:c("Departments")+" - Nefrit"});const _=xe(),k=ce();Be().setPageTitle(c("Departments_List"));const e=R({pagination:{current_page:1,per_page:10,total:10},result:[]}),S=C(!1),u=C([]),A=W(()=>e.result.length===u.value.length),v=C(),s=W({get:()=>e.pagination.current_page,set:async t=>{await x(t)}}),i=({order:t,a:o,b:$})=>t==="asc"?o.location.localeCompare($.location):t==="desc"?$.location.localeCompare(o.location):0,h=({searchTerm:t,row:o})=>t?o.name.toLocaleLowerCase().includes(t.toLocaleLowerCase())||o.bio.toLocaleLowerCase().includes(t.toLocaleLowerCase()):!0,V={select:{label:"",cellClass:"is-flex-grow-0"},orderNumber:{format:(t,o,$)=>`${$+1}`,cellClass:"is-flex-grow-0"},name:{label:c("Name"),searchable:!0,sortable:!0,sort:i,filter:h},actions:{label:c("Actions"),align:"center"}};[f,m]=ge(()=>x()),await f,m();function D(){A.value?u.value=[]:u.value=e.map(t=>t.id)}function F(t){u.value.includes(t.id)?u.value=u.value.filter(o=>o!==t.id):u.value=[...u.value,t.id]}function B(t){S.value=!0,v.value=t}function d(){u.value.length>0?k.$patch({confirmModalState:!0}):alert(c("No_row_selected"))}async function J(t){v.value=t,k.$patch({confirmModalState:!0})}async function Q(){await we(v.value),await x(),j()}async function x(t=1){const o=await Ce(t);Object.assign(e,o)}function j(){_.success(c("Success"))}return(t,o)=>{const $=ze,X=H,Y=K,Z=L,ee=Ae,P=Me,te=Le,ae=Je,oe=ke,ne=Se,le=Ne,se=Oe,ie=re;return g(),U("div",Qe,[a($,{center:"",title:"",onAdd:o[0]||(o[0]=y=>B(null)),"filter-disabled":!0,onRemove:d}),a(le,{columns:n(V),data:n(e).result,limit:n(e).pagination.per_page,total:n(e).pagination.total},{default:l(y=>[a(ee,null,{left:l(()=>[a(Z,null,{default:l(()=>[a(Y,{icon:"feather:search"},{default:l(()=>[a(X,{modelValue:y.searchInput,"onUpdate:modelValue":p=>y.searchInput=p,class:"is-rounded",placeholder:n(c)("Search")+"..."},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1024)]),_:2},1024)]),_:2},1024),a(oe,{rounded:""},{"header-column":l(({column:p})=>[p.key==="select"?(g(),M(P,{key:0,class:"ml-2 mr-3",checked:n(A),name:"all_selected",color:"primary",onClick:D},null,8,["checked"])):I("",!0),p.key==="orderNumber"?(g(),U("span",{key:1,class:"is-flex-grow-0",textContent:w("#")},null,8,Xe)):I("",!0)]),body:l(()=>[n(e).result.length===0?(g(),U("div",Ye,[a(te,{title:t.$t("No_data"),subtitle:t.$t("There_is_no_data_that_match_your_query"),class:"my-6"},null,8,["title","subtitle"])])):I("",!0)]),"body-cell":l(({row:p,column:q,value:Ze,index:et})=>[q.key==="select"?(g(),M(P,{key:0,modelValue:u.value,"onUpdate:modelValue":o[1]||(o[1]=T=>u.value=T),value:p.id,name:"selection",onChange:F},null,8,["modelValue","value"])):I("",!0),q.key==="actions"?(g(),M(ae,{key:1,onEdit:T=>B(p.id),onRemove:T=>J(p.id)},null,8,["onEdit","onRemove"])):I("",!0)]),_:1}),a(ne,{"current-page":n(s),"onUpdate:current-page":o[2]||(o[2]=p=>he(s)?s.value=p:null),class:"mt-6","item-per-page":n(e).pagination.per_page,"total-items":n(e).pagination.total},null,8,["current-page","item-per-page","total-items"])]),_:1},8,["columns","data","limit","total"]),a(se,{modelValue:S.value,"onUpdate:modelValue":o[3]||(o[3]=y=>S.value=y),"department-id":v.value,"onUpdate:list":o[4]||(o[4]=()=>{x(),j(),v.value=void 0}),onClose:o[5]||(o[5]=y=>v.value=void 0)},null,8,["modelValue","department-id"]),a(ie,{onConfirmAction:Q})])}}});export{bt as default};
