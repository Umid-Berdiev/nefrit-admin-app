import{_ as L}from"./VModal.vue_vue_type_style_index_0_lang.37ac83d6.js";import{z as q,N as x,A as p,r as $,B as E,D as j,p as k,o as z,f as P,w as i,j as o,q as n,E as l,t as _,v as R,m as T,a4 as G,a3 as H,a2 as J,P as K}from"./index.d938ffdf.js";import{_ as Q}from"./VFileInput.vue_vue_type_script_setup_true_lang.d3f74d25.js";import{i as W,u as X,m as Y}from"./index.c3da58b3.js";import{h as Z,i as ee}from"./index.42426b88.js";const te=["onSubmit"],ae={class:"columns is-multiline"},le={class:"column is-12"},ne={class:"help has-text-danger"},oe={class:"column is-12"},se={class:"help has-text-danger"},ie={class:"column is-12"},de={class:"help has-text-danger"},me={class:"column is-12"},ue={class:"help has-text-danger"},ce={class:"column is-12"},ge=q({props:{modelValue:Boolean,itemId:{type:Number,default:null}},emits:["update:modelValue","update:list"],setup(g,{emit:V}){const r=g,{t:y,locale:N}=x();let h=p(y("Add"));const u=p([]),I=p(),S=p(),a=$({legal_entity_id:null,name:"",payment_amount:0,template_file:"",applications:[]}),f=p([]),d=$({name:"",payment_amount:"",template_file:"",legal_entity_id:"",applications:""}),v=p(!1);E(async()=>{const t=await Z(N.value);I.value=t}),j(()=>r.itemId,async(t,e)=>{if(t){h.value=y("Edit");const s=await W(Number(r.itemId));Object.assign(a,s),f.value=s.applications.map(c=>c.id)}},{deep:!0,immediate:!0}),j(()=>a.legal_entity_id,async(t,e)=>{if(a.applications=[],t){const s=await ee(Number(t));S.value=s}},{deep:!0,immediate:!0});async function O(t){try{v.value=!0;const e=new FormData;e.append("name",a.name),e.append("payment_amount",a.payment_amount),e.append("template_file",u.value.length?u.value[0]:""),e.append("legal_entity_id",a.legal_entity_id),f.value.forEach(s=>{e.append("applications[]",s)}),r.itemId?await X(r.itemId,e):await Y(e),V("update:list"),C()}catch(e){Object.assign(d,e.response?.data?.errors)}finally{v.value=!1}}function C(){r.itemId||(h.value=y("Add"),u.value=[],Object.assign(a,{legal_entity_id:null,name:"",payment_amount:0,template_file:"",applications:[]}),Object.assign(d,{name:"",payment_amount:"",template_file:"",applications:"",legal_entity_id:""})),V("update:modelValue",!1)}function A(t){const e=t.target;u.value=e.files&&[e.files[0]]}function F(t){u.value=[]}return(t,e)=>{const s=G,c=H,w=k("Multiselect"),B=J,M=Q,U=K,D=L;return z(),P(D,{open:g.modelValue,size:"large",title:l(h),actions:"right",onClose:C},{content:i(()=>[o("form",{id:"contract-form",class:"modal-form",onSubmit:R(O,["prevent"])},[o("div",ae,[o("div",le,[n(c,{label:t.$t("Contract_name"),required:""},{default:i(()=>[n(s,{modelValue:l(a).name,"onUpdate:modelValue":e[0]||(e[0]=m=>l(a).name=m)},null,8,["modelValue"]),o("p",ne,_(l(d).name[0]),1)]),_:1},8,["label"])]),o("div",oe,[n(c,{label:t.$t("Contract_amount"),required:""},{default:i(()=>[n(s,{modelValue:l(a).payment_amount,"onUpdate:modelValue":e[1]||(e[1]=m=>l(a).payment_amount=m),type:"number"},null,8,["modelValue"]),o("p",se,_(l(d).payment_amount[0]),1)]),_:1},8,["label"])]),o("div",ie,[n(c,null,{default:i(({id:m})=>[n(B,null,{default:i(()=>[n(w,{modelValue:l(a).legal_entity_id,"onUpdate:modelValue":e[2]||(e[2]=b=>l(a).legal_entity_id=b),attrs:{id:m},searchable:!0,options:I.value,placeholder:t.$t("Select_applicant"),"value-prop":"id",label:"name",disabled:Boolean(g.itemId)},null,8,["modelValue","attrs","options","placeholder","disabled"])]),_:2},1024)]),_:1}),o("p",de,_(l(d).legal_entity_id[0]),1)]),o("div",me,[n(c,null,{default:i(({id:m})=>[n(B,null,{default:i(()=>[n(w,{modelValue:f.value,"onUpdate:modelValue":e[3]||(e[3]=b=>f.value=b),attrs:{id:m},searchable:!1,options:S.value,placeholder:t.$t("Select_statements"),"value-prop":"id",label:"code",mode:"tags","close-on-select":!1,disabled:!l(a).legal_entity_id},null,8,["modelValue","attrs","options","placeholder","disabled"])]),_:2},1024)]),_:1}),o("p",ue,_(l(d).applications[0]),1)]),o("div",ce,[n(M,{"error-message":l(d).template_file[0],files:u.value,"remote-files":[],onFileUpload:A,onFileRemove:F},null,8,["error-message","files"])])])],40,te)]),action:i(()=>[n(U,{loading:v.value,color:"primary",outlined:"",type:"submit",form:"contract-form",disabled:v.value},{default:i(()=>[T(_(t.$t("Save")),1)]),_:1},8,["loading","disabled"])]),_:1},8,["open","title"])}}});export{ge as _};
