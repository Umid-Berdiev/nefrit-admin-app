import{_ as ee}from"./ConfirmActionModal.vue_vue_type_script_setup_true_lang.a4d1edc6.js";import{_ as te}from"./VModal.vue_vue_type_style_index_0_lang.37ac83d6.js";import{af as ae,z as q,N as H,A as V,r as Y,D as oe,p as Q,o as m,f as F,w as l,j as n,q as t,i as b,E as o,t as f,l as w,x as ne,bn as le,v as N,m as G,bQ as se,a2 as ie,a3 as re,a4 as ue,P as J,$ as de,a0 as ce,Q as pe,O as _e,b as me,e as fe,bv as ve,G as ge}from"./index.d938ffdf.js";import{_ as he}from"./VTabs.vue_vue_type_script_setup_true_lang.3fba0469.js";import{_ as j}from"./VTextarea.4b9abff6.js";import{_ as ye,a as be}from"./VFlexTable.vue_vue_type_style_index_0_lang.e34ba883.js";import{_ as $e}from"./VFlexPagination.953d6fb8.js";import{_ as we}from"./VDropdown.vue_vue_type_style_index_0_lang.ac8830b3.js";import{_ as Ve}from"./VPlaceholderSection.vue_vue_type_style_index_0_lang.aa86f2fa.js";import{_ as ke}from"./VFlex.vue_vue_type_style_index_0_lang.15c4dc6d.js";import{u as De}from"./viewWrapper.f44ed784.js";import{u as Ce}from"./index.32b2a771.js";import"./VIcon.vue_vue_type_script_setup_true_lang.19322b13.js";const T=ae();async function ze(i){try{const{data:a}=await T({url:`/api/admin/regulation?page=${i}`});return a.data}catch(a){throw a}}async function Ie(i){try{const{data:a}=await T({url:`/api/admin/regulation/${i}`});return a.data}catch(a){throw a}}async function Te(i){try{const{data:a}=await T({url:"/api/admin/regulation",method:"POST",data:i});return a.data}catch(a){throw a}}async function Me(i,a){try{const{data:d}=await T({url:`/api/admin/regulation/${i}`,method:"POST",data:a});return d.data}catch(d){throw d}}async function Se(i){try{const{data:a}=await T({url:`/api/admin/regulation/${i}`,method:"DELETE"});return a.data}catch(a){throw a}}const L=i=>(de("data-v-c56e6267"),i=i(),ce(),i),Ye=["onSubmit"],Fe={key:0,class:"columns is-multiline pt-5"},Ne={class:"column is-12"},Ee={class:"help has-text-danger"},Re={key:1,class:"columns is-multiline pt-5"},xe={class:"column is-12"},Pe={key:2,class:"columns is-multiline pt-5"},Ae={class:"column is-12"},Be=L(()=>n("div",{class:"is-divider"},null,-1)),Ue={class:"file has-name"},Oe={class:"file-label"},je={class:"file-cta"},qe=L(()=>n("span",{class:"file-icon"},[n("i",{class:"fas fa-cloud-upload-alt"})],-1)),Le={class:"file-label"},We={key:0,class:"file-name light-text"},He={class:"help has-text-danger"},Qe=L(()=>n("div",{class:"is-divider"},null,-1)),Ge={class:"help has-text-danger"},Je=q({props:{modelValue:Boolean,regulationId:{type:Number,default:null}},emits:["update:modelValue","update:list"],setup(i,{emit:a}){const d=i,{t:c,locale:M}=H(),$=V(c("Add")),y=V(!1),k=V(),p=V(""),r=Y({title:{uz:"",ru:"",en:""},date:new Date,file:""}),z=Y({type:"string",mask:"YYYY-MM-DD"}),_=Y({"title.uz":[],"title.en":[],"title.ru":[],date:[],file:[]});oe(()=>d.regulationId,async u=>{if(u){$.value=c("Edit");const e=await Ie(Number(d.regulationId));Object.assign(r,e),p.value=e.file}},{deep:!0,immediate:!0});async function E(u){try{y.value=!0;const e=new FormData;e.append("date",se(r.date).format("YYYY-MM-DD")),e.append("file",k.value??""),e.append("title[uz]",r.title.uz),e.append("title[ru]",r.title.ru),e.append("title[en]",r.title.en),d.regulationId?await Me(d.regulationId,e):await Te(e),a("update:list"),I()}catch(e){Object.assign(_,e.response?.data?.errors)}finally{y.value=!1}}function I(){$.value=c("Add"),R(),x(),a("update:modelValue",!1)}function R(){Object.assign(r,{title:{uz:"",ru:"",en:""},date:new Date,file:""}),p.value="",k.value=void 0}function x(){Object.assign(_,{"title.uz":[],"title.en":[],"title.ru":[],date:[],file:[]})}function D(u){_.file=[];const e=u.target;k.value=e.files?e.files[0]:void 0}return(u,e)=>{const s=ie,v=re,P=he,A=ue,B=Q("VDatePicker"),U=J,O=te;return m(),F(O,{open:i.modelValue,size:"large",title:$.value,actions:"right",onClose:I},{content:l(()=>[n("form",{id:"role-form",class:"modal-form",onSubmit:N(E,["prevent"])},[t(P,{type:"boxed",selected:"uz",tabs:[{label:u.$t("Uzbek"),value:"uz"},{label:u.$t("Russian"),value:"ru"},{label:u.$t("English"),value:"en"}]},{tab:l(({activeValue:g})=>[g==="uz"?(m(),b("div",Fe,[n("div",Ne,[t(v,{label:u.$t("Title_uz"),required:""},{default:l(()=>[t(s,null,{default:l(()=>[t(j,{placeholder:o(c)("Type_title_uz"),modelValue:o(r).title.uz,"onUpdate:modelValue":e[0]||(e[0]=h=>o(r).title.uz=h),rows:3,onInput:e[1]||(e[1]=h=>o(_)["title.uz"]=[])},null,8,["placeholder","modelValue"]),n("p",Ee,f(o(_)["title.uz"][0]),1)]),_:1})]),_:1},8,["label"])])])):g==="ru"?(m(),b("div",Re,[n("div",xe,[t(v,{label:u.$t("Title_ru")},{default:l(()=>[t(s,null,{default:l(()=>[t(j,{placeholder:o(c)("Type_title_ru"),modelValue:o(r).title.ru,"onUpdate:modelValue":e[2]||(e[2]=h=>o(r).title.ru=h),rows:3},null,8,["placeholder","modelValue"])]),_:1})]),_:1},8,["label"])])])):g==="en"?(m(),b("div",Pe,[n("div",Ae,[t(v,{label:u.$t("Title_en")},{default:l(()=>[t(s,null,{default:l(()=>[t(j,{placeholder:o(c)("Type_title_en"),modelValue:o(r).title.en,"onUpdate:modelValue":e[3]||(e[3]=h=>o(r).title.en=h),rows:3},null,8,["placeholder","modelValue"])]),_:1})]),_:1},8,["label"])])])):w("",!0)]),_:1},8,["tabs"]),Be,t(v,{grouped:""},{default:l(()=>[t(s,null,{default:l(()=>[n("div",Ue,[n("label",Oe,[n("input",{class:"file-input",type:"file",name:"file",onChange:D},null,32),n("span",je,[qe,n("span",Le,f(u.$t("Choose_a_file")),1)]),k.value||p.value?(m(),b("span",We,f(k.value?.name??p.value),1)):w("",!0)])]),n("p",He,f(o(_).file[0]),1)]),_:1})]),_:1}),Qe,t(v,{grouped:""},{default:l(()=>[t(B,{modelValue:o(r).date,"onUpdate:modelValue":e[4]||(e[4]=g=>o(r).date=g),mode:"date","model-config":o(z),masks:{input:["YYYY-MM-DD"]}},{default:l(({inputValue:g,inputEvents:h})=>[t(v,{label:u.$t("Date")},{default:l(()=>[t(s,{icon:"feather:calendar"},{default:l(()=>[t(A,ne({value:g},le(h)),null,16,["value"]),n("p",Ge,f(o(_).date[0]),1)]),_:2},1024)]),_:2},1032,["label"])]),_:1},8,["modelValue","model-config"])]),_:1})],40,Ye)]),action:l(({close:g})=>[t(U,{loading:y.value,color:"primary",outlined:"",type:"submit",form:"role-form",disabled:y.value},{default:l(()=>[G(f(u.$t("Save")),1)]),_:1},8,["loading","disabled"])]),_:1},8,["open","title"])}}});const Ke=pe(Je,[["__scopeId","data-v-c56e6267"]]),Xe=["onClick"],Ze={class:"icon"},et={class:"meta"},tt=n("hr",{class:"dropdown-divider"},null,-1),at=["onClick"],ot={class:"icon"},nt={class:"meta"},lt=q({emits:["edit","remove"],setup(i,{emit:a}){return(d,c)=>{const M=Q("VueIconify"),$=we;return m(),F($,{icon:"feather:more-vertical",class:"is-pushed-mobile",spaced:"",right:""},{content:l(({close:y})=>[n("a",{role:"menuitem",href:"#",class:"dropdown-item is-media",onClick:N(()=>{a("edit"),y()},["prevent"])},[n("div",Ze,[t(M,{icon:"feather:edit-2"})]),n("div",et,[n("span",null,f(d.$t("Edit")),1)])],8,Xe),tt,n("a",{role:"menuitem",href:"#",class:"dropdown-item is-media",onClick:N(()=>{a("remove"),y()},["prevent"])},[n("div",ot,[t(M,{icon:"feather:trash"})]),n("div",nt,[n("span",null,f(d.$t("Remove")),1)])],8,at)]),_:1})}}}),st={class:"faq-list-wrapper"},it=["textContent"],rt={key:0,class:"flex-list-inner"},ut={key:0},kt=q({async setup(i){let a,d;const{t:c,locale:M}=H();_e({title:c("Regulation")+" - Nefrit"});const $=me(),y=Ce();De().setPageTitle(c("Regulation_List"));const p=Y({pagination:{current_page:1,per_page:10,total:10},result:[]}),r=fe({get:()=>p.pagination.current_page,set:async e=>{await D(e)}}),z=V(!1),_=V(),E={orderNumber:{format:(e,s,v)=>`${v+1}`,cellClass:"is-flex-grow-0"},title:{label:c("Title")},date:{label:c("Date")},actions:{label:c("Actions"),align:"center"}};V(),[a,d]=ve(()=>D()),await a,d();function I(e=void 0){z.value=!0,_.value=e}async function R(e){_.value=e,y.$patch({confirmModalState:!0})}async function x(){await Se(_.value),await D(),u()}async function D(e=1){const s=await ze(e);Object.assign(p,s)}function u(){$.success(c("Success"))}return(e,s)=>{const v=J,P=ke,A=Ve,B=lt,U=ye,O=$e,g=be,h=Ke,K=ee;return m(),b("div",st,[t(P,{"justify-content":"end",class:"mb-4"},{default:l(()=>[t(v,{outlined:"",rounded:"",color:"info",icon:"feather:plus",onClick:s[0]||(s[0]=N(S=>I(),["prevent"]))},{default:l(()=>[G(f(e.$t("Add")),1)]),_:1})]),_:1}),t(g,{columns:o(E),data:o(p).result,limit:o(p).pagination.per_page,total:o(p).pagination.total},{default:l(S=>[t(U,{rounded:""},{"header-column":l(({column:C})=>[C.key==="orderNumber"?(m(),b("span",{key:0,class:"is-flex-grow-0",textContent:f("#")},null,8,it)):w("",!0)]),body:l(()=>[o(p).result.length===0?(m(),b("div",rt,[t(A,{title:e.$t("No_data"),subtitle:e.$t("There_is_no_data_that_match_your_query"),class:"my-6"},null,8,["title","subtitle"])])):w("",!0)]),"body-cell":l(({row:C,column:W,value:X,index:dt})=>[W.key==="date"?(m(),b("span",ut,f(e.$h.formatDate(X,"DD.MM.YYYY")),1)):w("",!0),W.key==="actions"?(m(),F(B,{key:1,onEdit:Z=>I(C.id),onRemove:Z=>R(C.id)},null,8,["onEdit","onRemove"])):w("",!0)]),_:1}),o(p).result.length?(m(),F(O,{key:0,"current-page":o(r),"onUpdate:current-page":s[1]||(s[1]=C=>ge(r)?r.value=C:null),class:"mt-6","item-per-page":o(p).pagination.per_page,"total-items":o(p).pagination.total},null,8,["current-page","item-per-page","total-items"])):w("",!0)]),_:1},8,["columns","data","limit","total"]),t(h,{modelValue:z.value,"onUpdate:modelValue":s[2]||(s[2]=S=>z.value=S),"regulation-id":_.value,"onUpdate:list":s[3]||(s[3]=()=>{D(),u(),_.value=void 0}),onClose:s[4]||(s[4]=S=>_.value=void 0)},null,8,["modelValue","regulation-id"]),t(K,{onConfirmAction:x})])}}});export{kt as default};
