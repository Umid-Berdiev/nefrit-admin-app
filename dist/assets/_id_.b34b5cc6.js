import{_ as nt}from"./VTabs.c5221529.js";import{_ as X,u as it}from"./VModal.7c3df6a9.js";import{K as R,r as p,p as c,q as Y,s as o,y as t,f as a,H as Z,C as M,D as e,M as $,V as j,Q as rt,c as tt,U as E,bp as Q,E as W,x as d,B as V,F as H,G as ct,bL as ut,m as dt,bI as mt,o as _t}from"./index.f060b7c6.js";import{_ as pt}from"./VFileInput.5ba11aca.js";import{u as z}from"./vue-i18n.runtime.esm-bundler.1634ed66.js";import{e as ft,b as ht,g as yt,h as vt,i as bt}from"./index.fc264705.js";import{_ as gt}from"./ContractFormModal.075f0bf1.js";import{b as et,_ as $t,a as wt}from"./VFlexTable.4ba052d2.js";import{_ as Vt}from"./ListWidgetSingle.fe2c8b6c.js";import{_ as kt}from"./VTag.97e5d79c.js";import{u as at}from"./useNotyf.14aeb83f.js";import{_ as K}from"./VFlexItem.3714d147.js";import{u as Ct}from"./viewWrapper.7134460b.js";import{_ as Nt}from"./ConfirmActionModal.dc1a3c08.js";import{_ as Dt}from"./VFlexPagination.b3a191bb.js";import{_ as Mt}from"./VButtons.eeafcbc5.js";import{_ as St}from"./StatusTag.cb3350f7.js";import{_ as Ft}from"./VField.17e54227.js";import{_ as It}from"./VControl.068ba628.js";import"./VIcon.a5a02b18.js";import"./index.acac9876.js";import"./VPlaceholderSection.afc34ed0.js";const xt=["onSubmit"],Ut={class:"columns is-multiline"},Pt={class:"column is-12"},Bt=R({props:{modelValue:{type:Boolean,default:!1},contractId:{default:""},filePropName:null},emits:["update:modelValue","update:data"],setup(h,{emit:i}){const f=h,{t:r,locale:U}=z(),u=p([]),y=p("");let x=p(r("Add_file"));async function k(m){try{if(u.value.length){const _=new FormData;_.append(f.filePropName,u.value[0]??""),await ft(Number(f.contractId),_),i("update:data"),s()}else y.value=r("File_upload_field_required")}catch(_){Object.assign(errors,_.response?.data?.errors)}}function s(){u.value=[],y.value="",i("update:modelValue",!1)}function C(m){const _=m.target;u.value=_.files&&[_.files[0]],y.value=""}function v(){u.value=[]}return(m,_)=>{const b=pt,N=j,w=X;return c(),Y(w,{open:h.modelValue,size:"large",title:$(x),actions:"right",onClose:s},{content:o(()=>[t("form",{id:"submit-form2",class:"modal-form",onSubmit:Z(k,["prevent"])},[t("div",Ut,[t("div",Pt,[a(b,{files:u.value,onFileUpload:C,onFileRemove:v,"error-message":y.value,"remote-files":[]},null,8,["files","error-message"])])])],40,xt)]),action:o(({close:S})=>[a(N,{color:"primary",outlined:"",type:"submit",form:"submit-form2"},{default:o(()=>[M(e(m.$t("Save")),1)]),_:1})]),_:1},8,["open","title"])}}});const At={class:"container is-fluid"},Lt={class:"columns"},Tt={class:"column is-6"},Yt={class:"table is-hoverable is-bordered is-fullwidth mb-5"},jt={class:"has-text-weight-bold"},Ot={class:"has-text-weight-bold"},Ht={class:"has-text-weight-bold"},Rt={class:"has-text-weight-bold"},zt={class:"has-text-weight-bold"},Wt={class:"table is-hoverable is-bordered is-fullwidth"},Et={class:"has-text-weight-bold"},qt={class:"is-flex is-align-items-center"},Gt=["href"],Kt={class:"mr-3"},Qt={key:1,class:"has-text-danger"},Jt={class:"has-text-weight-bold"},Xt={class:"is-flex is-align-items-center"},Zt=["href"],te={class:"mr-3"},ee={key:1,class:"has-text-danger"},ae={class:"has-text-weight-bold"},oe={class:"is-flex is-align-items-center"},le=["href"],se={class:"mr-3"},ne={key:1,class:"has-text-danger"},ie={class:"column is-6"},re={class:"table is-hoverable is-bordered is-fullwidth"},ce=R({async setup(h){let i,f;const{t:r,locale:U}=z(),u=tt(()=>({name:{label:r("Name"),searchable:!0},legal_entity:{label:r("Applicant")},payment_amount:{label:r("Contract_amount")},template_file:{label:r("Template_file")},legal_file:{label:r("Legal_entity_file")},file:{label:r("File")},verified_at:{label:r("Payment_status")},created_at:{label:r("Date")}})),y=p(!1),k=E().params?.id??null,s=p(),C=p(),v=p(""),m=p(!1),_=at();[i,f]=Q(()=>b()),await i,f();async function b(){const l=await ht(Number(k));s.value=await l,C.value=s.value?.applications}function N(l){v.value=l,y.value=!0}function w(){m.value=!0}function S(){_.success(r("Updated_successfully"))}return(l,n)=>{const D=W("VueIconify"),F=kt,I=Vt,A=W("RouterLink"),O=et,q=gt,G=Bt;return c(),d("div",At,[t("div",Lt,[t("div",Tt,[a(I,{title:l.$t("Contract_details"),straight:"",class:"list-widget-v3"},{actions:o(()=>[s.value?.verified_at?V("",!0):(c(),d("a",{key:0,href:"javascript:;",onClick:w},[a(D,{icon:"feather:edit-2"})]))]),default:o(()=>[t("table",Yt,[t("tbody",null,[t("tr",null,[t("td",jt,e($(u).name.label),1),t("td",null,e(s.value?.name),1)]),t("tr",null,[t("td",Ot,e($(u).payment_amount.label),1),t("td",null,e(s.value?.payment_amount.toLocaleString()),1)]),t("tr",null,[t("td",Ht,e($(u).legal_entity.label),1),t("td",null,e(s.value?.legal_entity?.name),1)]),t("tr",null,[t("td",Rt,e($(u).created_at.label),1),t("td",null,e(l.$h.formatDate(s.value?.created_at,"DD.MM.YYYY")),1)]),t("tr",null,[t("td",zt,e($(u).verified_at.label),1),t("td",null,[a(F,{class:"is-size-6",color:s.value.verified_at?"primary":"warning",rounded:"",label:s.value.verified_at?l.$t("Paid"):l.$t("Not_Paid")},null,8,["color","label"])])])])])]),_:1},8,["title"]),a(I,{title:l.$t("Contract_files_list"),straight:"",class:"list-widget-v3"},{default:o(()=>[t("table",Wt,[t("tbody",null,[t("tr",null,[t("td",Et,e($(u).template_file.label),1),t("td",qt,[s.value?.template_file?(c(),d("a",{key:0,href:s.value?.template_file,class:"has-text-primary",download:""},[t("span",Kt,e(l.$t("Download")),1),a(D,{icon:"feather:link"})],8,Gt)):(c(),d("span",Qt,e(l.$t("No_template_file")),1)),a(j,{class:"ml-auto",color:"primary",rounded:"",icon:"fas fa-plus",onClick:n[0]||(n[0]=g=>N("template_file"))},{default:o(()=>[M(e(l.$t("Upload")),1)]),_:1})])]),t("tr",null,[t("td",Jt,e($(u).legal_file.label),1),t("td",Xt,[s.value?.legal_file?(c(),d("a",{key:0,href:s.value?.legal_file,class:"has-text-primary",download:""},[t("span",te,e(l.$t("Download")),1),a(D,{icon:"feather:link"})],8,Zt)):(c(),d("span",ee,e(l.$t("No_legal_file")),1))])]),t("tr",null,[t("td",ae,e($(u).file.label),1),t("td",oe,[s.value?.file?(c(),d("a",{key:0,href:s.value?.file,class:"has-text-primary",download:""},[t("span",se,e(l.$t("Download")),1),a(D,{icon:"feather:link"})],8,le)):(c(),d("span",ne,e(l.$t("No_completed_file")),1)),a(j,{class:"ml-auto",color:"primary",rounded:"",icon:"fas fa-plus",onClick:n[1]||(n[1]=g=>N("file"))},{default:o(()=>[M(e(l.$t("Upload")),1)]),_:1})])])])])]),_:1},8,["title"])]),t("div",ie,[a(I,{title:l.$t("Statements_List"),straight:"",class:"list-widget-v3"},{default:o(()=>[t("table",re,[t("thead",null,[t("tr",null,[t("th",null,e(l.$t("Statement_code")),1),t("th",null,e(l.$t("Drug_name")),1),t("th",null,e(l.$t("Status")),1)])]),t("tbody",null,[(c(!0),d(H,null,ct(C.value,g=>(c(),d("tr",null,[t("td",null,[a(A,{class:"has-text-primary",to:`/app/statements/${g.id}`},{default:o(()=>[M(e(g.code),1)]),_:2},1032,["to"])]),t("td",null,e(g.drug),1),t("td",null,[a(O,{"justify-content":"space-between"},{default:o(()=>[a(K,null,{default:o(()=>[a(F,{class:"is-size-6",color:g.is_paid?"primary":"warning",rounded:"",label:g.is_paid?l.$t("Paid"):l.$t("Not_Paid")},null,8,["color","label"])]),_:2},1024),g.is_paid&&!s.value?.verified_at?(c(),Y(K,{key:0},{default:o(()=>[a(j,{color:"warning",rounded:"",textContent:e(l.$t("Reject_statement_status"))},null,8,["textContent"])]),_:1})):V("",!0)]),_:2},1024)])]))),256))])])]),_:1},8,["title"])])]),a(q,{modelValue:m.value,"onUpdate:modelValue":n[2]||(n[2]=g=>m.value=g),"item-id":Number($(k)),"onUpdate:list":n[3]||(n[3]=()=>{b(),S(),k.value=""})},null,8,["modelValue","item-id"]),a(G,{modelValue:y.value,"onUpdate:modelValue":n[4]||(n[4]=g=>y.value=g),"contract-id":$(k),onClose:b,"file-prop-name":v.value,"onUpdate:data":b},null,8,["modelValue","contract-id","file-prop-name"])])}}}),ue=rt(ce,[["__scopeId","data-v-37db5c87"]]),J=ut();async function de(h,i){try{const{data:f}=await J({url:`/api/admin/payment/${h}/verify`,method:"PUT",data:{applications:i}});return f.data}catch(f){throw f}}async function me(h){try{const{data:i}=await J({url:`/api/admin/appcontract/${h}/verify`,method:"PUT"});return i.data}catch(i){throw i}}async function _e(h){try{const{data:i}=await J({url:`/api/admin/appcontract/${h}/application/not-verified`,method:"GET"});return i.data}catch(i){throw i}}const pe=["onSubmit"],fe={class:"columns is-multiline"},he={class:"column is-12"},ye={class:"help has-text-danger"},ve=R({props:{modelValue:Boolean,paymentId:{type:Number,default:null}},emits:["update:modelValue","update:list"],async setup(h,{emit:i}){let f,r;const U=h,{t:u,locale:y}=z(),k=E().params?.id??null;let s=p(u("Verify_payment"));const C=p(),v=p([]),m=dt({applications:""});[f,r]=Q(()=>_()),await f,r();async function _(){try{const w=await _e(Number(k));C.value=w}catch(w){console.log(w)}}async function b(w){try{await de(U.paymentId,v.value),i("update:list"),N()}catch(S){Object.assign(m,S.response?.data?.errors)}}function N(){v.value=[],i("update:modelValue",!1)}return(w,S)=>{const l=W("Multiselect"),n=It,D=Ft,F=j,I=X;return c(),Y(I,{open:h.modelValue,size:"large",title:$(s),actions:"right",onClose:N},{content:o(()=>[t("form",{id:"payment-verify-form",class:"modal-form",onSubmit:Z(b,["prevent"]),style:{"min-height":"200px"}},[t("div",fe,[t("div",he,[a(D,null,{default:o(({id:A})=>[a(n,null,{default:o(()=>[a(l,{modelValue:v.value,"onUpdate:modelValue":S[0]||(S[0]=O=>v.value=O),attrs:{id:A},searchable:!1,options:C.value,placeholder:w.$t("Select_statements"),valueProp:"id",label:"code",mode:"tags","close-on-select":!1,"append-new-option":!1},null,8,["modelValue","attrs","options","placeholder"])]),_:2},1024)]),_:1}),t("p",ye,e($(m).applications[0]),1)])])],40,pe)]),action:o(({close:A})=>[a(F,{color:"primary",outlined:"",type:"submit",form:"payment-verify-form"},{default:o(()=>[M(e(w.$t("Save")),1)]),_:1})]),_:1},8,["open","title"])}}}),be={class:"applicant-list-wrapper"},ge={class:"is-size-3 mb-3"},$e=["textContent"],we=["href"],Ve={class:"mr-3"},ke=R({async setup(h){let i,f;const{t:r,locale:U}=z(),y=E().params?.id??null,x=it(),k=at(),s=p(),C=p(null),v={orderNumber:{format:(n,D,F)=>`${F+1}`,cellClass:"is-flex-grow-0"},file:{label:r("Invoice"),grow:!0},amount:{label:r("Amount")},status:{label:r("Status")},created_at:{label:r("Paid_date")},verified_at:{label:r("Verified_date")},actions:{label:r("Actions"),align:"center"}},m=p(!1);[i,f]=Q(()=>_()),await i,f();async function _(){const n=await yt(Number(y));s.value=await n}async function b(n){C.value=n,m.value=!0}async function N(){x.$patch({confirmModalState:!0,confirmModalOkButtonColor:"primary"})}async function w(n){C.value=n,x.$patch({confirmModalState:!0})}async function S(){await me(y),await _()}function l(){k.success(r("Updated_successfully"))}return(n,D)=>{const F=K,I=j,A=et,O=W("VueIconify"),q=St,G=Mt,g=$t,ot=Dt,lt=wt,st=Nt;return c(),d("div",be,[a(A,{class:"mb-4","flex-wrap":"wrap"},{default:o(()=>[a(F,null,{default:o(()=>[t("h1",ge,e(n.$t("Payments")),1)]),_:1}),a(F,{class:"ml-auto"},{default:o(()=>[s.value?.verified_at?V("",!0):(c(),Y(I,{key:0,type:"button",rounded:"",color:"primary",icon:"feather:check",onClick:N},{default:o(()=>[M(e(n.$t("Verify_all")),1)]),_:1}))]),_:1})]),_:1}),a(lt,{columns:$(v),data:s.value.payments},{default:o(L=>[a(g,{rounded:""},{"header-column":o(({column:P})=>[P.key==="orderNumber"?(c(),d("span",{key:0,class:"is-flex-grow-0",textContent:e("#")},null,8,$e)):V("",!0)]),"body-cell":o(({row:P,column:T,value:B})=>[T.key==="file"?(c(),d("a",{key:0,href:P.file,class:"has-text-primary is-pushed-mobile"},[t("span",Ve,e(n.$t("Download")),1),a(O,{icon:"feather:link"})],8,we)):V("",!0),T.key==="amount"?(c(),d(H,{key:1},[M(e(Number(B).toLocaleString()),1)],64)):V("",!0),T.key==="status"&&B?(c(),Y(q,{key:2,status:B},null,8,["status"])):V("",!0),T.key==="created_at"&&B?(c(),d(H,{key:3},[M(e(n.$h.formatDate(B,"DD.MM.YYYY HH:mm")),1)],64)):V("",!0),T.key==="verified_at"&&B?(c(),d(H,{key:4},[M(e(n.$h.formatDate(B,"DD.MM.YYYY HH:mm")),1)],64)):V("",!0),T.key==="actions"?(c(),d(H,{key:5},[P.status?.color==="warning"?(c(),Y(G,{key:0},{default:o(()=>[a(I,{class:"is-primary is-outlined px-3",onClick:Me=>b(P.id)},{default:o(()=>[M(e(n.$t("Verify")),1)]),_:2},1032,["onClick"]),a(I,{class:"is-danger is-outlined px-3",onClick:w},{default:o(()=>[M(e(n.$t("Cancel")),1)]),_:1})]),_:2},1024)):V("",!0)],64)):V("",!0)]),_:1}),a(ot,{"current-page":L.page,"onUpdate:current-page":P=>L.page=P,class:"mt-6","item-per-page":L.limit,"total-items":L.total,"max-links-displayed":5,"no-router":""},null,8,["current-page","onUpdate:current-page","item-per-page","total-items"])]),_:1},8,["columns","data"]),a(ve,{modelValue:m.value,"onUpdate:modelValue":D[0]||(D[0]=L=>m.value=L),"payment-id":Number(C.value),"onUpdate:list":D[1]||(D[1]=()=>{_(),l()})},null,8,["modelValue","payment-id"]),a(st,{onConfirmAction:S})])}}}),Ce={class:"statement-detail-wrapper"},Ne={key:0,class:"columns mt-5"},De={key:1,class:"mt-5"},Je=R({setup(h){const{t:i,locale:f}=z(),r=E(),U=r.params?.id??null,u=p(r.hash.slice(1)||"details"),y=p([{label:i("Contract_details"),value:"details",icon:"lnil lnil-tap"},{label:i("Payment"),value:"payment",icon:"fas fa-tree"}]),x=p(),k=p(),s=p();return Ct().setPageTitle(i("Contract_card")),mt({title:tt(()=>i("Contract_card"))}),_t(async()=>{const v=await vt(Number(U)),m=await bt(Number(U));x.value=v,k.value=m,s.value=m.map((_,b)=>b)}),(v,m)=>{const _=ue,b=nt;return c(),d("div",Ce,[a(b,{selected:u.value,tabs:y.value},{tab:o(({activeValue:N})=>[N==="details"?(c(),d("div",Ne,[a(_)])):V("",!0),N==="payment"?(c(),d("div",De,[a(ke)])):V("",!0)]),_:1},8,["selected","tabs"])])}}});export{Je as default};
