import{_ as M}from"./VModal.vue_vue_type_style_index_0_lang.59ac8feb.js";import{z as R,N as j,e as Y,o as w,f as A,w as o,q as a,m as E,t as h,E as p,j as u,k as Z,G as ee,i as te,s as ae,F as le,bU as se,a1 as k,a2 as L,A as _,bx as O,r as z,D as T,v as G,a3 as oe,P as H}from"./index.9d6b139f.js";import{_ as J}from"./VTextarea.9c617097.js";import{F as ne,G as ue,H as ie,I as de,J as ce,K as me,L as re,M as _e}from"./index.ceb194c0.js";import{_ as pe}from"./VFileInput.vue_vue_type_script_setup_true_lang.c9be7aeb.js";import{_ as fe,a as ve}from"./VOption.vue_vue_type_style_index_0_lang.1a71d4e2.js";const K=R({props:{modelValue:{default:""},isRequired:{type:Boolean,default:!1},list:null},emits:["update:modelValue"],setup(b,{emit:$}){const f=b,{t:S}=j(),i=Y({get:()=>f.modelValue,set:async V=>{$("update:modelValue",V)}});return(V,g)=>{const v=se,d=fe,m=ve,n=k,x=L;return w(),A(x,null,{default:o(()=>[a(v,null,{default:o(()=>[E(h(p(S)("Status"))+" ",1),u("span",{class:Z({"has-text-danger":b.isRequired})},"*",2)]),_:1}),a(n,null,{default:o(()=>[a(m,{modelValue:p(i),"onUpdate:modelValue":g[0]||(g[0]=l=>ee(i)?i.value=l:null)},{default:o(()=>[a(d,{disabled:"",hidden:"",value:""},{default:o(()=>[E(h(p(S)("Select"))+" ...",1)]),_:1}),(w(!0),te(le,null,ae(b.list,l=>(w(),A(d,{key:l.id,value:l.id,textContent:h(l.name)},null,8,["value","textContent"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})}}}),Ve=["onSubmit"],ge={class:"columns is-multiline"},he={class:"column is-12"},be={class:"help has-text-danger"},xe={class:"column is-12"},Se={class:"help has-text-danger"},Ie={class:"column is-12"},ye={class:"help has-text-danger"},ke=R({props:{modelValue:Boolean,itemId:{type:Number,default:null},parentId:{type:Number,default:null}},emits:["update:modelValue","update:list"],async setup(b,{emit:$}){let f,S;const i=b,{t:V}=j();let g=_(V("Add"));const v=_(!1),d=_(""),m=_(""),n=_(),x=([f,S]=O(()=>ue()),f=await f,S(),f),l=z({message:"",text:"",status_id:""});T(()=>i.itemId,async r=>{if(!r)g.value=V("Add"),d.value="",m.value="",n.value="";else{g.value=V("Edit");const t=await ne(Number(i.itemId));d.value=t.message,m.value=t.text,n.value=t.status?.id}},{deep:!0,immediate:!0});async function U(r){try{v.value=!0;const t={message:d.value,text:m.value,application_id:i.parentId,status_id:n.value};i.itemId?await ie(i.itemId,t):await de(t),$("update:list"),I()}catch(t){console.log({error:t}),Object.assign(l,t.response?.data?.errors)}finally{v.value=!1}}function I(){d.value="",m.value="",n.value="",Object.assign(l,{message:"",text:"",status_id:""}),$("update:modelValue",!1)}function N(r){l[r.target.name]=""}return(r,t)=>{const D=oe,B=k,F=L,s=J,e=K,c=H,C=M;return w(),A(C,{open:b.modelValue,size:"large",title:p(g),actions:"right",onClose:I},{content:o(()=>[u("form",{id:"notice-form",class:"modal-form",onSubmit:G(U,["prevent"])},[u("div",ge,[u("div",he,[a(F,{label:r.$t("Notice_message"),required:""},{default:o(()=>[a(B,null,{default:o(()=>[a(D,{name:"message",modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=y=>d.value=y),onInput:N},null,8,["modelValue"]),u("p",be,h(p(l).message[0]),1)]),_:1})]),_:1},8,["label"])]),u("div",xe,[a(F,{label:r.$t("Notice_details"),required:""},{default:o(()=>[a(B,null,{default:o(()=>[a(s,{name:"text",placeholder:r.$t("Add_text"),modelValue:m.value,"onUpdate:modelValue":t[1]||(t[1]=y=>m.value=y),onInput:N},null,8,["placeholder","modelValue"]),u("p",Se,h(p(l).text[0]),1)]),_:1})]),_:1},8,["label"])]),u("div",Ie,[a(e,{name:"status_id",modelValue:n.value,"onUpdate:modelValue":t[2]||(t[2]=y=>n.value=y),list:p(x),"is-required":!0,onChange:N},null,8,["modelValue","list"]),u("p",ye,h(p(l).status_id[0]),1)])])],40,Ve)]),action:o(({close:y})=>[a(c,{loading:v.value,color:"primary",outlined:"",type:"submit",form:"notice-form",disabled:v.value},{default:o(()=>[E(h(r.$t("Save")),1)]),_:1},8,["loading","disabled"])]),_:1},8,["open","title"])}}}),$e=["onSubmit"],Ce={class:"columns is-multiline"},Ne={class:"column is-12"},we={class:"help has-text-danger"},Be={class:"column is-12"},Fe={class:"help has-text-danger"},qe={class:"column is-12"},Le=R({props:{modelValue:Boolean,itemId:{type:Number,default:null},parentId:{type:Number,default:null}},emits:["update:modelValue","update:list"],async setup(b,{emit:$}){let f,S;const i=b,{t:V}=j();let g=_(V("Add"));const v=_(!1),d=_(""),m=_(),n=_([]),x=_([]),l=_([]),U=([f,S]=O(()=>me()),f=await f,S(),f),I=z({text:"",status_id:""});T(()=>i.itemId,async(s,e)=>{if(s){g.value=V("Edit");const c=await ce(Number(i.itemId));d.value=c.text,m.value=c.status?.id,x.value=c.files}},{deep:!0,immediate:!0});async function N(s){try{v.value=!0;const e={text:d.value,application_id:i.parentId,status_id:m.value,files:n.value,removed_files:l.value},c=new FormData;c.append("text",e.text),c.append("application_id",e.application_id),c.append("status_id",e.status_id),n.value.forEach(C=>{c.append("files[]",C)}),l.value.forEach(C=>{c.append("removes[]",C)}),i.itemId?await re(i.itemId,c):await _e(c),$("update:list"),r()}catch(e){console.log({error:e}),Object.assign(I,e.response?.data?.errors)}finally{v.value=!1}}function r(){g.value=V("Add"),d.value="",m.value="",n.value=[],x.value=[],l.value=[],Object.assign(I,{text:"",status_id:""}),$("update:modelValue",!1)}function t(s){I[s.target.name]=""}function D(s){const e=s.target;console.log("files: ",e.files),e.files&&n.value?.push(e.files[0])}function B(s){n.value=n.value?.filter(e=>e.lastModified!==s)}function F(s){l.value.push(s),x.value=x.value?.filter(e=>e.id!==s)}return(s,e)=>{const c=J,C=k,y=L,P=K,Q=pe,W=H,X=M;return w(),A(X,{open:b.modelValue,size:"large",title:p(g),actions:"right",onClose:r},{content:o(()=>[u("form",{id:"conclusion-form",class:"modal-form",onSubmit:G(N,["prevent"])},[u("div",Ce,[u("div",Ne,[a(y,{label:s.$t("conclusion_in_details"),required:""},{default:o(()=>[a(C,null,{default:o(()=>[a(c,{name:"text",placeholder:s.$t("Add_text"),modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=q=>d.value=q),onInput:t},null,8,["placeholder","modelValue"]),u("p",we,h(p(I).text[0]),1)]),_:1})]),_:1},8,["label"])]),u("div",Be,[a(P,{name:"status_id",modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=q=>m.value=q),list:p(U),"is-required":!0,onChange:t},null,8,["modelValue","list"]),u("p",Fe,h(p(I).status_id[0]),1)]),u("div",qe,[a(Q,{files:n.value,"remote-files":x.value,onFileUpload:D,onFileRemove:B,onRemoteFileRemove:F,"error-message":""},null,8,["files","remote-files"])])])],40,$e)]),action:o(({close:q})=>[a(W,{loading:v.value,color:"primary",outlined:"",type:"submit",form:"conclusion-form",disabled:v.value},{default:o(()=>[E(h(s.$t("Save")),1)]),_:1},8,["loading","disabled"])]),_:1},8,["open","title"])}}});export{ke as _,Le as a,K as b};
